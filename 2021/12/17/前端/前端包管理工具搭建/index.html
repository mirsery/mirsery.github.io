<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 前端包管理私服搭建 · mirsery</title><meta name="description" content="前端包管理私服搭建 - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">前端包管理私服搭建</h1><div class="post-info">作者: mirsery         创建日期: 2021年12月17日</div><div class="post-content"><!-- toc -->

<ul>
<li><a href="#--dokcer----verdaccio">使用dokcer容器运行verdaccio</a></li>
<li><a href="#verdaccio--">verdaccio配置</a></li>
<li><a href="#----">创建用户</a></li>
</ul>
<!-- tocstop -->

<p>verdaccio 是一个简单的，零配置本地私有npm软件包代理注册表。verdaccio开箱即用，拥有自己的小型数据库，能够代理其他注册表（例如npmjs.org)，缓存下载的模块。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/verdaccio/verdaccio">verdaccio项目地址</a></p>
<h2 id="使用dokcer容器运行verdaccio"><a href="#使用dokcer容器运行verdaccio" class="headerlink" title="使用dokcer容器运行verdaccio"></a>使用dokcer容器运行verdaccio</h2><p><a target="_blank" rel="noopener" href="https://hub.docker.com/r/verdaccio/verdaccio">verdaccio docker 仓库地址 </a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run --restart=always --name verdaccio --privileged=true -v /&#123;location&#125;:/verdaccio -p 4873:4873 -d verdaccio/verdaccio<br></code></pre></td></tr></table></figure>

<h2 id="verdaccio配置"><a href="#verdaccio配置" class="headerlink" title="verdaccio配置"></a>verdaccio配置</h2><blockquote>
<p>容器内 /verdaccio/conf  配置文件</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#</span><br><span class="hljs-comment"># This is the config file used for the docker images.</span><br><span class="hljs-comment"># It allows all users to do anything, so don&#x27;t use it on production systems.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Do not configure host and port under `listen` in this file</span><br><span class="hljs-comment"># as it will be ignored when using docker.</span><br><span class="hljs-comment"># see https://verdaccio.org/docs/en/docker#docker-and-custom-port-configuration</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Look here for more config file examples:</span><br><span class="hljs-comment"># https://github.com/verdaccio/verdaccio/tree/master/conf</span><br><span class="hljs-comment">#</span><br><br><span class="hljs-comment"># path to a directory with all packages</span><br><span class="hljs-attr">storage:</span> <span class="hljs-string">/verdaccio/storage/data</span><br><span class="hljs-comment"># path to a directory with plugins to include</span><br><span class="hljs-attr">plugins:</span> <span class="hljs-string">/verdaccio/plugins</span><br><br><span class="hljs-attr">web:</span><br>  <span class="hljs-comment"># WebUI is enabled as default, if you want disable it, just uncomment this line</span><br>  <span class="hljs-comment">#enable: false</span><br>  <span class="hljs-attr">title:</span> <span class="hljs-string">Verdaccio</span><br>  <span class="hljs-comment"># comment out to disable gravatar support</span><br>  <span class="hljs-comment"># gravatar: false</span><br>  <span class="hljs-comment"># by default packages are ordercer ascendant (asc|desc)</span><br>  <span class="hljs-comment"># sort_packages: asc</span><br>  <span class="hljs-comment"># darkMode: true</span><br>  <span class="hljs-comment"># logo: http://somedomain/somelogo.png</span><br>  <span class="hljs-comment"># favicon: http://somedomain/favicon.ico | /path/favicon.ico</span><br><br><span class="hljs-comment"># translate your registry, api i18n not available yet</span><br><span class="hljs-comment"># i18n:</span><br><span class="hljs-comment"># list of the available translations https://github.com/verdaccio/ui/tree/master/i18n/translations</span><br><span class="hljs-comment">#   web: en-US</span><br><br><span class="hljs-attr">auth:</span><br>  <span class="hljs-attr">htpasswd:</span><br>    <span class="hljs-attr">file:</span> <span class="hljs-string">/verdaccio/storage/htpasswd</span><br>    <span class="hljs-comment"># Maximum amount of users allowed to register, defaults to &quot;+infinity&quot;.</span><br>    <span class="hljs-comment"># You can set this to -1 to disable registration.</span><br>    <span class="hljs-comment"># max_users: 1000</span><br><br><span class="hljs-comment"># a list of other known repositories we can talk to</span><br><span class="hljs-attr">uplinks:</span><br>  <span class="hljs-attr">taobao:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">https://registry.npm.taobao.org/</span><br>  <span class="hljs-attr">npmjs:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">https://registry.npmjs.org/</span><br><br><span class="hljs-attr">packages:</span><br>  <span class="hljs-string">&#x27;@*/*&#x27;</span><span class="hljs-string">:</span><br>    <span class="hljs-comment"># scoped packages</span><br>    <span class="hljs-attr">access:</span> <span class="hljs-string">$all</span><br>    <span class="hljs-attr">publish:</span> <span class="hljs-string">$authenticated</span><br>    <span class="hljs-attr">unpublish:</span> <span class="hljs-string">$authenticated</span><br>    <span class="hljs-attr">proxy:</span> <span class="hljs-string">taobao</span><br><br>  <span class="hljs-string">&#x27;**&#x27;</span><span class="hljs-string">:</span><br>    <span class="hljs-comment"># allow all users (including non-authenticated users) to read and</span><br>    <span class="hljs-comment"># publish all packages</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># you can specify usernames/groupnames (depending on your auth plugin)</span><br>    <span class="hljs-comment"># and three keywords: &quot;$all&quot;, &quot;$anonymous&quot;, &quot;$authenticated&quot;</span><br>    <span class="hljs-attr">access:</span> <span class="hljs-string">$all</span><br><br>    <span class="hljs-comment"># allow all known users to publish/publish packages</span><br>    <span class="hljs-comment"># (anyone can register by default, remember?)</span><br>    <span class="hljs-attr">publish:</span> <span class="hljs-string">$authenticated</span><br>    <span class="hljs-attr">unpublish:</span> <span class="hljs-string">$authenticated</span><br><br>    <span class="hljs-comment"># if package is not available locally, proxy requests to &#x27;npmjs&#x27; registry</span><br>    <span class="hljs-attr">proxy:</span> <span class="hljs-string">taobao</span><br><br><span class="hljs-comment"># You can specify HTTP/1.1 server keep alive timeout in seconds for incoming connections.</span><br><span class="hljs-comment"># A value of 0 makes the http server behave similarly to Node.js versions prior to 8.0.0, which did not have a keep-alive timeout.</span><br><span class="hljs-comment"># WORKAROUND: Through given configuration you can workaround following issue https://github.com/verdaccio/verdaccio/issues/301. Set to 0 in case 60 is not enough.</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">keepAliveTimeout:</span> <span class="hljs-number">60</span><br><br><span class="hljs-attr">middlewares:</span><br>  <span class="hljs-attr">audit:</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># log settings</span><br><span class="hljs-attr">logs:</span> &#123; <span class="hljs-attr">type:</span> <span class="hljs-string">stdout</span>, <span class="hljs-attr">format:</span> <span class="hljs-string">pretty</span>, <span class="hljs-attr">level:</span> <span class="hljs-string">http</span> &#125;<br><br><span class="hljs-comment">#experiments:</span><br><span class="hljs-comment">#  # support for npm token command</span><br><span class="hljs-comment">#  token: false</span><br><span class="hljs-comment">#  # enable tarball URL redirect for hosting tarball with a different server, the tarball_url_redirect can be a template string</span><br><span class="hljs-comment">#  tarball_url_redirect: &#x27;https://mycdn.com/verdaccio/$&#123;packageName&#125;/$&#123;filename&#125;&#x27;</span><br><span class="hljs-comment">#  # the tarball_url_redirect can be a function, takes packageName and filename and returns the url, when working with a js configuration file</span><br><span class="hljs-comment">#  tarball_url_redirect(packageName, filename) &#123;</span><br><span class="hljs-comment">#    const signedUrl = // generate a signed url</span><br><span class="hljs-comment">#    return signedUrl;</span><br><span class="hljs-comment">#  &#125;</span><br><br><span class="hljs-comment"># This affect the web and api (not developed yet)</span><br><span class="hljs-comment">#i18n:</span><br><span class="hljs-comment">#web: en-US</span><br></code></pre></td></tr></table></figure>
<p>上面是一些默认配置，我们可以简单的进行一些个性化的修改。</p>
<h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>在容器内执行如下命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm adduser --registry http://localhost:4873 # 该地址为登录地址<br></code></pre></td></tr></table></figure>
<p>接着输入用户名和密码以及邮箱完成注册，完成注册之后可以登录web页面查看信息。</p>
</div></div></div></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2022/01/07/%E5%89%8D%E7%AB%AF/%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AEwebstorm%E5%92%8Cvscode%E6%94%AF%E6%8C%81vue%E5%88%AB%E5%90%8D%E7%9A%84%E8%AF%86%E5%88%AB-md/">上一篇</a><a class="next" href="/2021/12/10/docker/docker%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E4%B8%8E%E6%B8%85%E7%90%86%E9%97%AE%E9%A2%98/">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script></body></html>
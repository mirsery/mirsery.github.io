<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 前端包管理私服搭建 · mirsery</title><meta name="description" content="前端包管理私服搭建 - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">前端包管理私服搭建</h1><div class="post-info">作者: mirsery         创建日期: 2021年12月17日</div><div class="post-content"><!-- toc -->

<ul>
<li><a href="#--dokcer----verdaccio">使用dokcer容器运行verdaccio</a></li>
<li><a href="#verdaccio--">verdaccio配置</a></li>
<li><a href="#----">创建用户</a></li>
</ul>
<!-- tocstop -->

<p>verdaccio 是一个简单的，零配置本地私有npm软件包代理注册表。verdaccio开箱即用，拥有自己的小型数据库，能够代理其他注册表（例如npmjs.org)，缓存下载的模块。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/verdaccio/verdaccio">verdaccio项目地址</a></p>
<h2 id="使用dokcer容器运行verdaccio"><a href="#使用dokcer容器运行verdaccio" class="headerlink" title="使用dokcer容器运行verdaccio"></a>使用dokcer容器运行verdaccio</h2><p><a target="_blank" rel="noopener" href="https://hub.docker.com/r/verdaccio/verdaccio">verdaccio docker 仓库地址 </a></p>
<pre><code class="highlight shell">docker run --restart=always --name verdaccio --privileged=true -v /&#123;location&#125;:/verdaccio -p 4873:4873 -d verdaccio/verdaccio</code></pre>

<h2 id="verdaccio配置"><a href="#verdaccio配置" class="headerlink" title="verdaccio配置"></a>verdaccio配置</h2><blockquote>
<p>容器内 /verdaccio/conf  配置文件</p>
</blockquote>
<pre><code class="highlight yaml"><span class="comment">#</span>
<span class="comment"># This is the config file used for the docker images.</span>
<span class="comment"># It allows all users to do anything, so don&#x27;t use it on production systems.</span>
<span class="comment">#</span>
<span class="comment"># Do not configure host and port under `listen` in this file</span>
<span class="comment"># as it will be ignored when using docker.</span>
<span class="comment"># see https://verdaccio.org/docs/en/docker#docker-and-custom-port-configuration</span>
<span class="comment">#</span>
<span class="comment"># Look here for more config file examples:</span>
<span class="comment"># https://github.com/verdaccio/verdaccio/tree/master/conf</span>
<span class="comment">#</span>

<span class="comment"># path to a directory with all packages</span>
<span class="attr">storage:</span> <span class="string">/verdaccio/storage/data</span>
<span class="comment"># path to a directory with plugins to include</span>
<span class="attr">plugins:</span> <span class="string">/verdaccio/plugins</span>

<span class="attr">web:</span>
  <span class="comment"># WebUI is enabled as default, if you want disable it, just uncomment this line</span>
  <span class="comment">#enable: false</span>
  <span class="attr">title:</span> <span class="string">Verdaccio</span>
  <span class="comment"># comment out to disable gravatar support</span>
  <span class="comment"># gravatar: false</span>
  <span class="comment"># by default packages are ordercer ascendant (asc|desc)</span>
  <span class="comment"># sort_packages: asc</span>
  <span class="comment"># darkMode: true</span>
  <span class="comment"># logo: http://somedomain/somelogo.png</span>
  <span class="comment"># favicon: http://somedomain/favicon.ico | /path/favicon.ico</span>

<span class="comment"># translate your registry, api i18n not available yet</span>
<span class="comment"># i18n:</span>
<span class="comment"># list of the available translations https://github.com/verdaccio/ui/tree/master/i18n/translations</span>
<span class="comment">#   web: en-US</span>

<span class="attr">auth:</span>
  <span class="attr">htpasswd:</span>
    <span class="attr">file:</span> <span class="string">/verdaccio/storage/htpasswd</span>
    <span class="comment"># Maximum amount of users allowed to register, defaults to &quot;+infinity&quot;.</span>
    <span class="comment"># You can set this to -1 to disable registration.</span>
    <span class="comment"># max_users: 1000</span>

<span class="comment"># a list of other known repositories we can talk to</span>
<span class="attr">uplinks:</span>
  <span class="attr">taobao:</span>
    <span class="attr">url:</span> <span class="string">https://registry.npm.taobao.org/</span>
  <span class="attr">npmjs:</span>
    <span class="attr">url:</span> <span class="string">https://registry.npmjs.org/</span>

<span class="attr">packages:</span>
  <span class="string">&#x27;@*/*&#x27;</span><span class="string">:</span>
    <span class="comment"># scoped packages</span>
    <span class="attr">access:</span> <span class="string">$all</span>
    <span class="attr">publish:</span> <span class="string">$authenticated</span>
    <span class="attr">unpublish:</span> <span class="string">$authenticated</span>
    <span class="attr">proxy:</span> <span class="string">taobao</span>

  <span class="string">&#x27;**&#x27;</span><span class="string">:</span>
    <span class="comment"># allow all users (including non-authenticated users) to read and</span>
    <span class="comment"># publish all packages</span>
    <span class="comment">#</span>
    <span class="comment"># you can specify usernames/groupnames (depending on your auth plugin)</span>
    <span class="comment"># and three keywords: &quot;$all&quot;, &quot;$anonymous&quot;, &quot;$authenticated&quot;</span>
    <span class="attr">access:</span> <span class="string">$all</span>

    <span class="comment"># allow all known users to publish/publish packages</span>
    <span class="comment"># (anyone can register by default, remember?)</span>
    <span class="attr">publish:</span> <span class="string">$authenticated</span>
    <span class="attr">unpublish:</span> <span class="string">$authenticated</span>

    <span class="comment"># if package is not available locally, proxy requests to &#x27;npmjs&#x27; registry</span>
    <span class="attr">proxy:</span> <span class="string">taobao</span>

<span class="comment"># You can specify HTTP/1.1 server keep alive timeout in seconds for incoming connections.</span>
<span class="comment"># A value of 0 makes the http server behave similarly to Node.js versions prior to 8.0.0, which did not have a keep-alive timeout.</span>
<span class="comment"># WORKAROUND: Through given configuration you can workaround following issue https://github.com/verdaccio/verdaccio/issues/301. Set to 0 in case 60 is not enough.</span>
<span class="attr">server:</span>
  <span class="attr">keepAliveTimeout:</span> <span class="number">60</span>

<span class="attr">middlewares:</span>
  <span class="attr">audit:</span>
    <span class="attr">enabled:</span> <span class="literal">true</span>

<span class="comment"># log settings</span>
<span class="attr">logs:</span> &#123; <span class="attr">type:</span> <span class="string">stdout</span>, <span class="attr">format:</span> <span class="string">pretty</span>, <span class="attr">level:</span> <span class="string">http</span> &#125;

<span class="comment">#experiments:</span>
<span class="comment">#  # support for npm token command</span>
<span class="comment">#  token: false</span>
<span class="comment">#  # enable tarball URL redirect for hosting tarball with a different server, the tarball_url_redirect can be a template string</span>
<span class="comment">#  tarball_url_redirect: &#x27;https://mycdn.com/verdaccio/$&#123;packageName&#125;/$&#123;filename&#125;&#x27;</span>
<span class="comment">#  # the tarball_url_redirect can be a function, takes packageName and filename and returns the url, when working with a js configuration file</span>
<span class="comment">#  tarball_url_redirect(packageName, filename) &#123;</span>
<span class="comment">#    const signedUrl = // generate a signed url</span>
<span class="comment">#    return signedUrl;</span>
<span class="comment">#  &#125;</span>

<span class="comment"># This affect the web and api (not developed yet)</span>
<span class="comment">#i18n:</span>
<span class="comment">#web: en-US</span></code></pre>
<p>上面是一些默认配置，我们可以简单的进行一些个性化的修改。</p>
<h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>在容器内执行如下命令:</p>
<pre><code class="highlight shell">npm adduser --registry http://localhost:4873 # 该地址为登录地址</code></pre>
<p>接着输入用户名和密码以及邮箱完成注册，完成注册之后可以登录web页面查看信息。</p>
</div></div></div></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2022/01/07/%E5%89%8D%E7%AB%AF/%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AEwebstorm%E5%92%8Cvscode%E6%94%AF%E6%8C%81vue%E5%88%AB%E5%90%8D%E7%9A%84%E8%AF%86%E5%88%AB/">上一篇</a><a class="next" href="/2021/12/10/docker/docker%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E4%B8%8E%E6%B8%85%E7%90%86%E9%97%AE%E9%A2%98/">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script></body></html>
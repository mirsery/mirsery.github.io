<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> RSA 算法加解密代码实现片段 · mirsery</title><meta name="description" content="RSA 算法加解密代码实现片段 - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">RSA 算法加解密代码实现片段</h1><div class="post-info">作者: mirsery         创建日期: 2021年5月23日</div><div class="post-content"><h1><span id="rsa-算法加解密代码实现片段">RSA 算法加解密代码实现片段</span></h1><blockquote>
<p> 采用java</p>
</blockquote>
<!-- toc -->

<ul>
<li><a href="#%E7%A7%98%E9%92%A5%E7%94%9F%E6%88%90">秘钥生成</a></li>
<li><a href="#%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86">公钥加密</a></li>
<li><a href="#%E5%85%AC%E9%92%A5%E8%A7%A3%E5%AF%86">公钥解密</a></li>
<li><a href="#%E7%A7%81%E9%92%A5%E5%8A%A0%E5%AF%86">私钥加密</a></li>
<li><a href="#%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86">私钥解密</a></li>
</ul>
<!-- tocstop -->

<h2><span id="秘钥生成">秘钥生成</span></h2><pre><code class="highlight java"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initKey</span><span class="params">()</span> </span>&#123;
      KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">&quot;RSA&quot;</span>);
      keyPairGenerator.initialize(<span class="number">2048</span>);<span class="comment">//长度必须为64的倍数 512~65536 之间</span>
      KeyPair keyPair = keyPairGenerator.generateKeyPair();
      RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); <span class="comment">//公钥</span>
      RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();    <span class="comment">//私钥</span>
  &#125;</code></pre>

<h2><span id="公钥加密">公钥加密</span></h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">byte</span>[] encryptByPublicKey(<span class="keyword">byte</span>[] data, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;
      KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);
      X509EncodedKeySpec x509KeySpec = <span class="keyword">new</span> X509EncodedKeySpec(key);
      PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);
      Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
      cipher.init(Cipher.ENCRYPT_MODE, pubKey);
      <span class="keyword">return</span> cipher.doFinal(data);
  &#125;</code></pre>

<h2><span id="公钥解密">公钥解密</span></h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">byte</span>[] decryptByPublicKey(<span class="keyword">byte</span>[] data) <span class="keyword">throws</span> Exception &#123;
       ByteArrayOutputStream out = <span class="keyword">new</span> ByteArrayOutputStream();
       KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
       X509EncodedKeySpec x509KeySpec = <span class="keyword">new</span> X509EncodedKeySpec(Base64.getDecoder().decode(publicKey.trim()));
       PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);
       Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
       cipher.init(Cipher.DECRYPT_MODE, pubKey);
       <span class="keyword">int</span> inputLen = data.length;
       <span class="keyword">int</span> offSet = <span class="number">0</span>;
       <span class="keyword">byte</span>[] cache;
       <span class="keyword">int</span> i = <span class="number">0</span>;
       <span class="keyword">while</span> (inputLen - offSet &gt; <span class="number">0</span>) &#123;
           <span class="keyword">if</span> (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123;
               cache = cipher.doFinal(data, offSet, MAX_DECRYPT_BLOCK);
           &#125; <span class="keyword">else</span> &#123;
               cache = cipher.doFinal(data, offSet, inputLen - offSet);
           &#125;
           out.write(cache, <span class="number">0</span>, cache.length);
           i++;
           offSet = i * MAX_DECRYPT_BLOCK;
       &#125;
       out.close();
       <span class="keyword">return</span> out.toByteArray();
   &#125;</code></pre>

<h2><span id="私钥加密">私钥加密</span></h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">byte</span>[] encryptByPrivateKey(<span class="keyword">byte</span>[] data, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;
        ByteArrayOutputStream out = <span class="keyword">new</span> ByteArrayOutputStream();
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(key);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, privateKey);
        <span class="keyword">int</span> inputLen = data.length;
        <span class="keyword">int</span> offSet = <span class="number">0</span>;
        <span class="keyword">byte</span>[] cache;
        <span class="keyword">int</span> i = <span class="number">0</span>;
        <span class="keyword">while</span> (inputLen - offSet &gt; <span class="number">0</span>) &#123;
            <span class="keyword">if</span> (inputLen - offSet &gt; MAX_ENCRYPT_BLOCK) &#123;
                cache = cipher.doFinal(data, offSet, MAX_ENCRYPT_BLOCK);
            &#125; <span class="keyword">else</span> &#123;
                cache = cipher.doFinal(data, offSet, inputLen - offSet);
            &#125;
            out.write(cache, <span class="number">0</span>, cache.length);
            i++;
            offSet = i * MAX_ENCRYPT_BLOCK;
        &#125;
        out.close();
        <span class="keyword">return</span> out.toByteArray();
    &#125;</code></pre>

<h2><span id="私钥解密">私钥解密</span></h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">byte</span>[] decryptByPrivateKey(<span class="keyword">byte</span>[] data, <span class="keyword">byte</span>[] key) <span class="keyword">throws</span> Exception &#123;
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(key);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, privateKey);
        <span class="keyword">return</span> cipher.doFinal(data);
    &#125;</code></pre></div></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mirsery';
var disqus_identifier = '2021/05/22/java/2021/java RSA 加密解密代码片段/';
var disqus_title = 'RSA 算法加解密代码实现片段';
var disqus_url = 'https://mirsery.github.io/2021/05/22/java/2021/java RSA 加密解密代码片段/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2021/06/07/java/2021/Springboot%20%E6%A1%86%E6%9E%B6%E8%87%AA%E5%B8%A6%E7%9A%84md5%E6%91%98%E8%A6%81/">上一篇</a><a class="next" href="/2021/05/12/docker/%E7%AE%80%E6%98%93docker%20registry%E6%90%AD%E5%BB%BA%E8%84%9A%E6%9C%AC/">下一篇</a></div><div class="copyright"><p>© 2015 - 2023 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script></body></html>
<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> RSA 算法加解密代码实现片段 · mirsery</title><meta name="description" content="RSA 算法加解密代码实现片段 - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">RSA 算法加解密代码实现片段</h1><div class="post-info">作者: mirsery         创建日期: 2021年5月23日</div><div class="post-content"><h1 id="RSA-算法加解密代码实现片段"><a href="#RSA-算法加解密代码实现片段" class="headerlink" title="RSA 算法加解密代码实现片段"></a>RSA 算法加解密代码实现片段</h1><blockquote>
<p> 采用java</p>
</blockquote>
<!-- toc -->

<ul>
<li><a href="#----">秘钥生成</a></li>
<li><a href="#----">公钥加密</a></li>
<li><a href="#----">公钥解密</a></li>
<li><a href="#----">私钥加密</a></li>
<li><a href="#----">私钥解密</a></li>
</ul>
<!-- tocstop -->

<h2 id="秘钥生成"><a href="#秘钥生成" class="headerlink" title="秘钥生成"></a>秘钥生成</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initKey</span><span class="hljs-params">()</span> </span>&#123;<br>      KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="hljs-string">&quot;RSA&quot;</span>);<br>      keyPairGenerator.initialize(<span class="hljs-number">2048</span>);<span class="hljs-comment">//长度必须为64的倍数 512~65536 之间</span><br>      KeyPair keyPair = keyPairGenerator.generateKeyPair();<br>      RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); <span class="hljs-comment">//公钥</span><br>      RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();    <span class="hljs-comment">//私钥</span><br>  &#125;<br></code></pre></td></tr></table></figure>

<h2 id="公钥加密"><a href="#公钥加密" class="headerlink" title="公钥加密"></a>公钥加密</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] encryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>      KeyFactory keyFactory = KeyFactory.getInstance(<span class="hljs-string">&quot;RSA&quot;</span>);<br>      X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(key);<br>      PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);<br>      Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>      cipher.init(Cipher.ENCRYPT_MODE, pubKey);<br>      <span class="hljs-keyword">return</span> cipher.doFinal(data);<br>  &#125;<br></code></pre></td></tr></table></figure>

<h2 id="公钥解密"><a href="#公钥解密" class="headerlink" title="公钥解密"></a>公钥解密</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] decryptByPublicKey(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception &#123;<br>       ByteArrayOutputStream out = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>       KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>       X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(Base64.getDecoder().decode(publicKey.trim()));<br>       PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);<br>       Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>       cipher.init(Cipher.DECRYPT_MODE, pubKey);<br>       <span class="hljs-keyword">int</span> inputLen = data.length;<br>       <span class="hljs-keyword">int</span> offSet = <span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">byte</span>[] cache;<br>       <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">while</span> (inputLen - offSet &gt; <span class="hljs-number">0</span>) &#123;<br>           <span class="hljs-keyword">if</span> (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123;<br>               cache = cipher.doFinal(data, offSet, MAX_DECRYPT_BLOCK);<br>           &#125; <span class="hljs-keyword">else</span> &#123;<br>               cache = cipher.doFinal(data, offSet, inputLen - offSet);<br>           &#125;<br>           out.write(cache, <span class="hljs-number">0</span>, cache.length);<br>           i++;<br>           offSet = i * MAX_DECRYPT_BLOCK;<br>       &#125;<br>       out.close();<br>       <span class="hljs-keyword">return</span> out.toByteArray();<br>   &#125;<br></code></pre></td></tr></table></figure>

<h2 id="私钥加密"><a href="#私钥加密" class="headerlink" title="私钥加密"></a>私钥加密</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] encryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>        ByteArrayOutputStream out = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(key);<br>        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);<br>        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>        cipher.init(Cipher.ENCRYPT_MODE, privateKey);<br>        <span class="hljs-keyword">int</span> inputLen = data.length;<br>        <span class="hljs-keyword">int</span> offSet = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">byte</span>[] cache;<br>        <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (inputLen - offSet &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> (inputLen - offSet &gt; MAX_ENCRYPT_BLOCK) &#123;<br>                cache = cipher.doFinal(data, offSet, MAX_ENCRYPT_BLOCK);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cache = cipher.doFinal(data, offSet, inputLen - offSet);<br>            &#125;<br>            out.write(cache, <span class="hljs-number">0</span>, cache.length);<br>            i++;<br>            offSet = i * MAX_ENCRYPT_BLOCK;<br>        &#125;<br>        out.close();<br>        <span class="hljs-keyword">return</span> out.toByteArray();<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="私钥解密"><a href="#私钥解密" class="headerlink" title="私钥解密"></a>私钥解密</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] decryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(key);<br>        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);<br>        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>        cipher.init(Cipher.DECRYPT_MODE, privateKey);<br>        <span class="hljs-keyword">return</span> cipher.doFinal(data);<br>    &#125;<br></code></pre></td></tr></table></figure></div></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mirsery';
var disqus_identifier = '2021/05/22/java/2021/java RSA 加密解密代码片段/';
var disqus_title = 'RSA 算法加解密代码实现片段';
var disqus_url = 'https://mirsery.github.io/2021/05/22/java/2021/java RSA 加密解密代码片段/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2021/06/07/java/2021/Springboot%20%E6%A1%86%E6%9E%B6%E8%87%AA%E5%B8%A6%E7%9A%84md5%E6%91%98%E8%A6%81/">上一篇</a><a class="next" href="/2021/05/12/docker/%E7%AE%80%E6%98%93docker%20registry%E6%90%AD%E5%BB%BA%E8%84%9A%E6%9C%AC/">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script></body></html>
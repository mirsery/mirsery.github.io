---
title: javad对象的创建
date: 2016-11-24 13:28:10
tags:
  - jvm
categories: 
  - java
---


## 创建普通的java对象 
在语言层面上，创建对象（例如克隆、反序列化）通常仅是一个new关键字而已，而在虚拟机中，对象（文中讨论的对象仅限于普通java对象）。
虚拟机遇到一条new指令时，首先将去检查这个指令的参数是否在常量池中定位到一个类的符号引用，并且检查这个符号引用代表的类是否已被加载、解析和初始化过。如果没有，那必须先执行相应的类加载过程。
在类加载检查通过后，接下来虚拟机将会为新生对象分配内存。对象所需内存的大小在类加载完成后便可以完全确定。为对象分配空间的任务等同于把一块确定大小的内存从java堆中划分出来。
## 指针碰撞    
假设java堆中内存是绝对规整的，所有用过的内存都放在一边，空闲的内存放在另一边，中间放着一个指针作为分界点的指示器，那所分配内存就仅仅是把那个指针向空闲空间那边挪动一段与对象大小相等的距离，这种分配方式称为“指针碰撞”。
## 空闲列表
如果java堆中的内存并不是规整的，已经使用的内存和空闲的内存交相互错，那就没有办法简单地进行指针碰撞了，虚拟机就必须维护一个列表，记录下哪些内存是可用的，在分配的时候从列表上找到一块足够大的空间划分给对象实例，并更新列表上的记录，这种分配方式称为“空闲列表”。
## 对象优先在Eden生成
大多数情况下，对象在新生代Eden区中分配，当Eden区没有足够的空间进行分配时虚拟机将发起一次Minor GC.
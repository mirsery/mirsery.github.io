<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> git打标签 · mirsery</title><meta name="description" content="git打标签 - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">git打标签</h1><div class="post-info">2016年8月6日</div><div class="post-content"><ul>
<li>列出现有的标签的命令<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">git tag<br></code></pre></td></tr></table></figure></li>
<li>新建标签<br>Git 使用的标签有两种类型：轻量级的（lightweight）和含附注的（annotated）。轻量级标签就像是个不会变化的分支，实际上它就是个指向特定提交对象的引用。而含附注标签，实际上是存储在仓库中的一个独立对象，它有自身的校验和信息，包含着标签的名字，电子邮件地址和日期，以及标签说明，标签本身也允许使用 GNU Privacy Guard (GPG) 来签署或验证。一般我们都建议使用含附注型的标签，以便保留相关信息；当然，如果只是临时性加注标签，或者不需要旁注额外信息，用轻量级标签也没问题。</li>
<li>含附注的标签<br>创建一个含附注类型的标签非常简单，用 -a （译注：取 annotated 的首字母）指定标签名字即可：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git tag -a v1.4 -m &#x27;my version 1.4&#x27;<br>$ git tag<br>v0.1<br>v1.3<br>v1.4<br></code></pre></td></tr></table></figure>
而 -m 选项则指定了对应的标签说明，Git 会将此说明一同保存在标签对象中。如果在此选项后没有给出具体的说明内容，Git 会启动文本编辑软件供你输入。<br>可以使用 git show 命令查看相应标签的版本信息，并连同显示打标签时的提交对象。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git show v1.4<br>tag v1.4<br>...<br></code></pre></td></tr></table></figure></li>
<li>签署标签</li>
</ul>
<p>如果你有自己的私钥，还可以用 GPG 来签署标签，只需要把之前的 -a 改为 -s （译注： 取 Signed 的首字母）即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git tag -s v1.5 -m &#x27;my signed 1.5 tag&#x27;<br>You need a passphrase to unlock the secret key for<br>user: &quot;Scott Chacon &lt;schacon@gee-mail.com&gt;&quot;<br>1024-bit DSA key, ID F721C45A, created 2009-02-09<br>现在再运行 git show 会看到对应的 GPG 签名也附在其内：<br>$ git show v1.5<br>tag v1.5<br>Tagger: Scott Chacon &lt;schacon@gee-mail.com&gt;<br>Date:   Mon Feb 9 15:22:20 2009 -0800<br><br>my signed 1.5 tag<br>-----BEGIN PGP SIGNATURE-----<br>Version: GnuPG v1.4.8 (Darwin)<br><br>iEYEABECAAYFAkmQurIACgkQON3DxfchxFr5cACeIMN+ZxLKggJQf0QYiQBwgySN<br>Ki0An2JeAVUCAiJ7Ox6ZEtK+NvZAj82/<br>=WryJ<br>-----END PGP SIGNATURE-----<br>commit 15027957951b64cf874c3557a0f3547bd83b3ff6<br>Merge: 4a447f7... a6b4c97...<br>Author: Scott Chacon &lt;schacon@gee-mail.com&gt;<br>Date:   Sun Feb 8 19:02:46 2009 -0800<br><br>    Merge branch &#x27;experiment&#x27;<br></code></pre></td></tr></table></figure>
<ul>
<li>轻量级标签<br>轻量级标签实际上就是一个保存着对应提交对象的校验和信息的文件。要创建这样的标签，一个 -a，-s 或 -m 选项都不用，直接给出标签名字即可：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git tag v1.4-lw<br>$ git tag<br>v0.1<br>v1.3<br>v1.4<br>v1.4-lw<br>v1.5<br></code></pre></td></tr></table></figure></li>
<li>验证标签</li>
</ul>
<p>可以使用 git tag -v [tag-name] （译注：取 verify 的首字母）的方式验证已经签署的标签。此命令会调用 GPG 来验证签名，所以你需要有签署者的公钥，存放在 keyring 中，才能验证：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git tag -v v1.4.2.1<br>object 883653babd8ee7ea23e6a5c392bb739348b1eb61<br>type commit<br>tag v1.4.2.1<br>tagger Junio C Hamano &lt;junkio@cox.net&gt; 1158138501 -0700<br><br>GIT 1.4.2.1<br><br>Minor fixes since 1.4.2, including git-mv and git-http with alternates.<br>gpg: Signature made Wed Sep 13 02:08:25 2006 PDT using DSA key ID F3119B9A<br>gpg: Good signature from &quot;Junio C Hamano &lt;junkio@cox.net&gt;&quot;<br>gpg:                 aka &quot;[jpeg image of size 1513]&quot;<br>Primary key fingerprint: 3565 2A26 2040 E066 C9A7  4A7D C0C6 D9A4 F311 9B9A<br>若是没有签署者的公钥，会报告类似下面这样的错误：<br><br>gpg: Signature made Wed Sep 13 02:08:25 2006 PDT using DSA key ID F3119B9A<br>gpg: Can&#x27;t check signature: public key not found<br>error: could not verify the tag &#x27;v1.4.2.1 <br><br></code></pre></td></tr></table></figure>
<ul>
<li>后期加注标签</li>
</ul>
<p>你甚至可以在后期对早先的某次提交加注标签。比如在下面展示的提交历史中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git log --pretty=oneline<br>15027957951b64cf874c3557a0f3547bd83b3ff6 Merge branch &#x27;experiment&#x27;<br>a6b4c97498bd301d84096da251c98a07c7723e65 beginning write support<br>0d52aaab4479697da7686c15f77a3d64d9165190 one more thing<br>6d52a271eda8725415634dd79daabbc4d9b6008e Merge branch &#x27;experiment&#x27;<br>0b7434d86859cc7b8c3d5e1dddfed66ff742fcbc added a commit function<br>4682c3261057305bdd616e23b64b0857d832627b added a todo file<br>166ae0c4d3f420721acbb115cc33848dfcc2121a started write support<br>9fceb02d0ae598e95dc970b74767f19372d61af8 updated rakefile<br>964f16d36dfccde844893cac5b347e7b3d44abbc commit the todo<br>8a5cbc430f1a9c3d00faaeffd07798508422908a updated readme<br></code></pre></td></tr></table></figure>
<p>我们忘了在提交 “updated rakefile” 后为此项目打上版本号 v1.2，没关系，现在也能做。只要在打标签的时候跟上对应提交对象的校验和（或前几位字符）即可：<br>$ git tag -a v1.2 9fceb02<br>可以看到我们已经补上了标签：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git tag <br>v0.1<br>v1.2<br>v1.3<br>v1.4<br>v1.4-lw<br></code></pre></td></tr></table></figure>
<ul>
<li>分享标签</li>
</ul>
<p>默认情况下，git push 并不会把标签传送到远端服务器上，只有通过显式命令才能分享标签到远端仓库。其命令格式如同推送分支，运行 git push origin [tagname] 即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git push origin v1.5<br>Counting objects: 50, done.<br>Compressing objects: 100% (38/38), done.<br>Writing objects: 100% (44/44), 4.56 KiB, done.<br>Total 44 (delta 18), reused 8 (delta 1)<br>To git@github.com:schacon/simplegit.git<br>* [new tag]         v1.5 -&gt; v1.5<br></code></pre></td></tr></table></figure>
<p>如果要一次推送所有（本地新增的）标签上去，可以使用 –tags 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ git push origin --tags<br>Counting objects: 50, done.<br>Compressing objects: 100% (38/38), done.<br>Writing objects: 100% (44/44), 4.56 KiB, done.<br>Total 44 (delta 18), reused 8 (delta 1)<br>To git@github.com:schacon/simplegit.git<br> * [new tag]         v0.1 -&gt; v0.1<br> * [new tag]         v1.2 -&gt; v1.2<br> * [new tag]         v1.4 -&gt; v1.4<br> * [new tag]         v1.4-lw -&gt; v1.4-lw<br> * [new tag]         v1.5 -&gt; v1.5<br></code></pre></td></tr></table></figure>
<p>现在，其他人克隆共享仓库或拉取数据同步后，也会看到这些标签。</p>
</div></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mirsery';
var disqus_identifier = '2016/08/06/git/git打标签/';
var disqus_title = 'git打标签';
var disqus_url = 'https://mirsery.github.io/2016/08/06/git/git打标签/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2016/08/06/git/git%E7%9A%84rebase%E5%92%8Cmerge/">上一篇</a><a class="next" href="/2016/08/06/git/git%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/">下一篇</a></div><div class="copyright"><p>© 2015 - 2021 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script></body></html>
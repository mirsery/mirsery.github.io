<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> springboot interceptor · mirsery</title><meta name="description" content="springboot interceptor - mirsery"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="stylesheet" href="/css/dracula.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mirsery.github.io/atom.xml" title="mirsery"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="mirsery" type="application/atom+xml">
<!-- hexo-inject:begin --><script src='https://unpkg.com/echarts@3.3.2/dist/echarts.min.js'></script><!-- hexo-inject:end --></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">mirsery</h2></a></div><a class="li component-nav-item" href="/" target="_self"><p>首页</p></a><a class="li component-nav-item" href="/archives" target="_self"><p>归档</p></a><a class="li component-nav-item" href="/categories" target="_self"><p>分类</p></a><a class="li component-nav-item" href="/tags" target="_self"><p>标签</p></a><ul class="shortcut-icons"><a href="https://github.com/mirsery" target="_blank"><img class="icon" src="/images/github.svg"></a><a href="/atom.xml" target="_blank"><img class="icon" src="/images/rss.svg"></a><a href="https://www.zhihu.com/people/mirsery" target="_blank"><img class="icon" src="/images/zhihu.svg"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post article post-block"><h1 class="post-title">springboot interceptor</h1><div class="post-info">作者: mirsery         创建日期: 2018年9月16日</div><div class="post-content"><h1><span id="interceptor">interceptor</span></h1><p>Spring MVC interceptor intercepts the actual request and response. Interceptors are a special web programming technique, where we can execute a certain piece of logic before or after a web request is processed. </p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><h2><span id="working-with-interceptors">working with interceptors</span></h2><p>As I have already mentioned, interceptors are used to intercept actual web requests before or after processing them. We can relate the concept of interceptors in Spring MVC to the filter concept in Servlet programming. In Spring MVC, interceptors are special classes that must implement the org.springframework.web.servlet.HandlerInterceptor interface. The HandlerInterceptor interface defines three important methods, as follows:<br>preHandle: This method will get called just before the web request reaches the Controller for execution<br>postHandle: This method will get called just after the Controller method execution<br>afterCompletion: This method will get called after the completion of the entire web request cycle<br>Once we create our own interceptor, by implementing the HandlerInterceptor interface, we need to configure it in our web application context in order for it to take effect.</p>
<h2><span id="configure-an-interceptor">configure an interceptor</span></h2><p> a interceptor ‘s class demo:</p>
<pre><code class="highlight java">
<span class="keyword">package</span> com.packt.webstore.interceptor;
<span class="keyword">import</span> javax.servlet.http.HttpServletRequest;
<span class="keyword">import</span> javax.servlet.http.HttpServletResponse;
<span class="keyword">import</span> org.apache.log4j.Logger;
<span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;
<span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProcessingTimeLogInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;
   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOGGER</span> <span class="operator">=</span>Logger.getLogger(ProcessingTimeLogInterceptor.class);
   <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request,</span>
<span class="params">     HttpServletResponse response, Object handler)</span> &#123;
           <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();
           request.setAttribute(<span class="string">&quot;startTime&quot;</span>, startTime);
           <span class="keyword">return</span> <span class="literal">true</span>;
       &#125;
   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request,</span>
<span class="params">       HttpServletResponse response, Object handler, ModelAndView</span>
<span class="params">       modelAndView)</span> &#123;
           <span class="type">String</span> <span class="variable">queryString</span> <span class="operator">=</span> request.getQueryString() == <span class="literal">null</span> ?
   <span class="string">&quot;&quot;</span> : <span class="string">&quot;?&quot;</span> + request.getQueryString();
           <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> request.getRequestURL() + queryString;
           <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> (Long)
           request.getAttribute(<span class="string">&quot;startTime&quot;</span>);
           <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();
           LOGGER.info(String.format(<span class="string">&quot;%s millisecond taken to process the request %s.&quot;</span>,(endTime - startTime), path));
    &#125;
     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request,</span>
<span class="params">       HttpServletResponse response, Object handler, Exception</span>
<span class="params">       exceptionIfAny)</span>&#123;
          <span class="comment">// NO operation.</span>
       &#125;
&#125;</code></pre>
<p>open your web application context configuration file WebApplicationContextConfig.java, add the following method to it, and save the file:</p>
<pre><code class="highlight java"> <span class="meta">@Override</span>
<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;
    registry.addInterceptor(<span class="keyword">new</span>
    <span class="title class_">ProcessingTimeLogInterceptor</span>());
&#125;</code></pre>
</div></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mirsery';
var disqus_identifier = '2018/09/15/java/2018/Spring interceptor/';
var disqus_title = 'springboot interceptor';
var disqus_url = 'https://mirsery.github.io/2018/09/15/java/2018/Spring interceptor/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a class="prev" href="/2018/09/21/%E5%89%8D%E7%AB%AF/JavaScript%E4%BB%A3%E7%A0%81%E6%B1%82%E5%80%BC/">上一篇</a><a class="next" href="/2018/09/05/java/2018/Java%20Web%20Application/">下一篇</a></div><div class="copyright"><p>© 2015 - 2024 <a href="https://mirsery.github.io">mirsery</a> </p><p>powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and  <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a></p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"mirsery",'auto');ga('send','pageview');</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7201423389984397" crossorigin="anonymous"></script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>
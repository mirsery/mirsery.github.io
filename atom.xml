<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>mirsery</title>
  
  <subtitle>兴趣使然博客</subtitle>
  <link href="https://mirsery.github.io/atom.xml" rel="self"/>
  
  <link href="https://mirsery.github.io/"/>
  <updated>2021-07-14T09:14:01.381Z</updated>
  <id>https://mirsery.github.io/</id>
  
  <author>
    <name>mirsery</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>java运算符</title>
    <link href="https://mirsery.github.io/2021/07/12/java/java%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    <id>https://mirsery.github.io/2021/07/12/java/java%E8%BF%90%E7%AE%97%E7%AC%A6/</id>
    <published>2021-07-12T05:07:17.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 运算符是一种特殊的符号，用来表示数据的运算，赋值和比较等。</p></blockquote><h2><span id="算术运算符">算术运算符</span></h2><p>四则混合运算： <strong>+</strong> , <strong>-</strong>, <strong>x</strong> , <strong>/</strong> </p><p>取模运算：<strong>%</strong> , 取模运算的结果和被模数的正负相关。例如 <strong>-5 % 3 = -2</strong></p><h2><span id="赋值运算符">赋值运算符</span></h2><p><strong>+=</strong>, <strong>-=</strong> ,<strong>/=</strong> , <strong>*=</strong> ,<strong>%=</strong> , <strong>=</strong></p><h2><span id="逻辑运算符">逻辑运算符</span></h2><p><strong>&amp;</strong>,  <strong>|</strong>,  <strong>!</strong>,  <strong>&amp;&amp;</strong>,  <strong>||</strong>,  <strong>^</strong></p><h2><span id="位运算符">位运算符</span></h2><blockquote><p>位运算符操作的都是整型数据</p></blockquote><ul><li><strong>&lt;&lt; 1</strong> 左移，相当于<strong>*2</strong>(正数高位补0，负数补1)</li><li><strong>&gt;&gt; 1</strong> 右移，相当于**/2** (正数高位补0，负数补1)</li><li><strong>&gt;&gt;&gt;</strong> 无符号右移，不管此整数正负高位都补0</li></ul><h3><span id="交换两个变量的值">交换两个变量的值</span></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> m = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">int</span> n = <span class="hljs-number">5</span>;<br><span class="hljs-keyword">int</span> temp = m;<br>m = n;<br>n = temp;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">m = m + n ;<br>n = m - n ;<br>m = m - n;<br></code></pre></td></tr></table></figure><p>使用位运算：原理（ m ^ n ) ^ n = m</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">m = m ^ n;<br>n = m ^ n;<br>m = m ^ n;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">运算符是一种特殊的符号，用来表示数据的运算，赋值和比较等...</summary>
    
    
    
    <category term="运算符" scheme="https://mirsery.github.io/categories/%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    
    
    <category term="java" scheme="https://mirsery.github.io/tags/java/"/>
    
    <category term="运算符" scheme="https://mirsery.github.io/tags/%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    
  </entry>
  
  <entry>
    <title>xss和csrf攻击</title>
    <link href="https://mirsery.github.io/2021/07/12/web/xss%E5%92%8Ccsrf%E6%94%BB%E5%87%BB/"/>
    <id>https://mirsery.github.io/2021/07/12/web/xss%E5%92%8Ccsrf%E6%94%BB%E5%87%BB/</id>
    <published>2021-07-12T01:31:45.000Z</published>
    <updated>2021-07-14T09:14:01.385Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="xss和csrf攻击">xss和csrf攻击</span></h1><h2><span id="xss">xss</span></h2><p>xss（cross-site scripting,简称xss）跨站脚本攻击是一种迫使web站点回显可执行代码的攻击技术，而这些可执行代码由攻击者提供，被终端用户浏览器所加载执行。XSS的主要目的是获取客户端的Cookie或者其他网站用户识别客户端身份的敏感信息。获取到合法用户的信息后，攻击者可以假冒最终用户与网站进行交互。<br>xss漏洞的成因是由于动态页面的web应用对用户提交参数未作充分的检查过滤，允许用户在提交的数据中插入HTML代码，然后未加编码输出到用户的浏览器，这些恶意的提交代码会被受害用户的浏览器解释执行。</p><h2><span id="csrf">csrf</span></h2><p>csrf（cross-site-request-forgery）跨站请求伪造。简单讲就是从A网站发起一个到B网站的请求，而这个请求是经过了伪装的，伪装操作达到的目的就是让请求看起来像是从网站B中发起的，也就是说让B网站所在的服务器误以为该请求是从自己网站发起的，而不是A网站发起的。</p>]]></content>
    
    
    <summary type="html">xss（cross-site scripting,简称xss）跨站脚本攻击是一种迫使web站点回显可执行代码的攻击技术，而这些可执行代码由攻击者提供...</summary>
    
    
    
    <category term="web" scheme="https://mirsery.github.io/categories/web/"/>
    
    
    <category term="网络安全" scheme="https://mirsery.github.io/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>文章迁移</title>
    <link href="https://mirsery.github.io/2021/07/09/talk/%E6%96%87%E7%AB%A0%E8%BF%81%E7%A7%BB/"/>
    <id>https://mirsery.github.io/2021/07/09/talk/%E6%96%87%E7%AB%A0%E8%BF%81%E7%A7%BB/</id>
    <published>2021-07-09T05:47:45.000Z</published>
    <updated>2021-07-14T09:14:01.385Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="文章迁移">文章迁移</span></h1><p>从15年末开始，陆陆续续记录的一些文档因为某些不可抗力的原因，需要做一些迁移的工作。刚开始写博客的时候用的farbox，后来迁移到bitcron,现在要回归github pages。记录一次文档的迁移过程吧。</p>]]></content>
    
    
    <summary type="html">这是一个简单的测试描述文字</summary>
    
    
    
    <category term="生活" scheme="https://mirsery.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="闲谈" scheme="https://mirsery.github.io/tags/%E9%97%B2%E8%B0%88/"/>
    
  </entry>
  
  <entry>
    <title>java 中面向切面的Aop 解析</title>
    <link href="https://mirsery.github.io/2021/06/12/java/java%E4%B8%AD%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2aop%E8%A7%A3%E6%9E%90/"/>
    <id>https://mirsery.github.io/2021/06/12/java/java%E4%B8%AD%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2aop%E8%A7%A3%E6%9E%90/</id>
    <published>2021-06-12T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="aop-解析">Aop 解析</span></h1><blockquote><p> 了解aop协议</p></blockquote><!-- toc --><ul><li><a href="#%E5%AE%9E%E7%8E%B0%E7%AE%80%E6%98%93%E7%9A%84aop">实现简易的Aop</a></li></ul><!-- tocstop --><p>AOP（面向切面编程）是Spring框架的特色功能之一。通过设置横切关注点（cross cutting concerns），AOP提供了极高的扩展性。</p><h2><span id="实现简易的aop">实现简易的Aop</span></h2><ol><li>定义一个 需要被代理的接口，并实现接口</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Job</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doWork</span><span class="hljs-params">(String msg)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Work</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Job</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doWork</span><span class="hljs-params">(String msg)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;[do-work] &quot;</span> + msg);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>实现InvocationHandler接口并创建代理方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Object o;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WorkHandler</span><span class="hljs-params">(Object o)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.o = o;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>        method.invoke(o, args);<br>        System.out.println(<span class="hljs-string">&quot;[proxy-invoke]&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>场景测试类</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkMain</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Job work = <span class="hljs-keyword">new</span> Work();<br>        WorkHandler workHandler = <span class="hljs-keyword">new</span> WorkHandler(work);<br>        Job job = (Job) Proxy.newProxyInstance(work.getClass().getClassLoader(),<br>                work.getClass().getInterfaces(),workHandler);<br>        System.out.println(job.doWork(<span class="hljs-string">&quot;hahahah&quot;</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;aop-解析&quot;&gt;Aop 解析&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 了解aop协议&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%AE%9E%E7%8E%B0%E7%AE</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="aop" scheme="https://mirsery.github.io/tags/aop/"/>
    
  </entry>
  
  <entry>
    <title>Swagger-ui 使用</title>
    <link href="https://mirsery.github.io/2021/06/08/java/Swagger-ui%20%E4%BD%BF%E7%94%A8/"/>
    <id>https://mirsery.github.io/2021/06/08/java/Swagger-ui%20%E4%BD%BF%E7%94%A8/</id>
    <published>2021-06-08T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="swagger-ui-使用">Swagger-ui 使用</span></h1><!-- toc --><ul><li><a href="#%E5%BC%95%E5%85%A5%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96jar%E5%8C%85">引入相关依赖jar包</a></li><li><a href="#%E5%90%AF%E7%94%A8-swagger">启用 swagger</a></li><li><a href="#controller-%E6%B7%BB%E5%8A%A0%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF">Controller 添加描述信息</a></li><li><a href="#%E6%8E%A5%E5%8F%A3%E6%B7%BB%E5%8A%A0%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF">接口添加描述信息</a></li><li><a href="#%E7%BB%99%E5%AE%9E%E4%BD%93%E7%B1%BB%E6%B7%BB%E5%8A%A0%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF">给实体类添加描述信息</a></li></ul><!-- tocstop --><h2><span id="引入相关依赖jar包">引入相关依赖jar包</span></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2><span id="启用-swagger">启用 swagger</span></h2><p>下面是swagger-ui 配置样例:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;<br><span class="hljs-keyword">import</span> springfox.documentation.builders.PathSelectors;<br><span class="hljs-keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;<br><span class="hljs-keyword">import</span> springfox.documentation.service.ApiInfo;<br><span class="hljs-keyword">import</span> springfox.documentation.service.ApiKey;<br><span class="hljs-keyword">import</span> springfox.documentation.service.AuthorizationScope;<br><span class="hljs-keyword">import</span> springfox.documentation.service.SecurityReference;<br><span class="hljs-keyword">import</span> springfox.documentation.service.SecurityScheme;<br><span class="hljs-keyword">import</span> springfox.documentation.spi.DocumentationType;<br><span class="hljs-keyword">import</span> springfox.documentation.spi.service.contexts.SecurityContext;<br><span class="hljs-keyword">import</span> springfox.documentation.spring.web.plugins.Docket;<br><span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span>:</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span>: misery</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span>: 2021-06-04 16:26</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableSwagger2</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SwaggerConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;swagger.enable:false&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> swagger2Enable;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">createRestApi</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.OAS_30).apiInfo(apiInfo())<br>                .enable(swagger2Enable)<br>                .groupName(<span class="hljs-string">&quot;所有&quot;</span>)<br>                .select()<br>                .apis(RequestHandlerSelectors.any())<br>                .paths(PathSelectors.any())<br>                .paths(PathSelectors.regex(<span class="hljs-string">&quot;(?!/error.*).*&quot;</span>))     <span class="hljs-comment">// 去除默认basicController</span><br>                .paths(PathSelectors.regex(<span class="hljs-string">&quot;(?!/actuator.*).*&quot;</span>))    <span class="hljs-comment">//去除actuator</span><br>                .build()<br>                .securityContexts(securityContext())<br>                .securitySchemes(security());<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">appApi</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.OAS_30).apiInfo(apiInfo())<br>                .enable(swagger2Enable)<br>                .groupName(<span class="hljs-string">&quot;groupName&quot;</span>)<br>                .select()<br>                .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.xxxx.xxx&quot;</span>))<br>                .paths(PathSelectors.any())<br>                .build()<br>                .securityContexts(securityContext())<br>                .securitySchemes(security());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title">apiInfo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ApiInfoBuilder()<br>                .title(<span class="hljs-string">&quot;title&quot;</span>)<br>                .description(<span class="hljs-string">&quot;description&quot;</span>)<br>                .version(<span class="hljs-string">&quot;0.0.1&quot;</span>)<br>                .build();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;SecurityScheme&gt; <span class="hljs-title">security</span><span class="hljs-params">()</span> </span>&#123;<br>        SecurityScheme token = <span class="hljs-keyword">new</span> ApiKey(<span class="hljs-string">&quot;token&quot;</span>, <span class="hljs-string">&quot;token&quot;</span>, <span class="hljs-string">&quot;header&quot;</span>);<br>        List&lt;SecurityScheme&gt; securitySchemeList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        securitySchemeList.add(token);<br>        <span class="hljs-keyword">return</span> securitySchemeList;<br>    &#125;<br><br>    <span class="hljs-function">List&lt;SecurityReference&gt; <span class="hljs-title">defaultAuth</span><span class="hljs-params">()</span> </span>&#123;<br>        AuthorizationScope authorizationScope<br>                = <span class="hljs-keyword">new</span> AuthorizationScope(<span class="hljs-string">&quot;global&quot;</span>, <span class="hljs-string">&quot;accessEverything&quot;</span>);<br>        AuthorizationScope[] authorizationScopes = <span class="hljs-keyword">new</span> AuthorizationScope[<span class="hljs-number">1</span>];<br>        authorizationScopes[<span class="hljs-number">0</span>] = authorizationScope;<br>        List&lt;SecurityReference&gt; lists = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        lists.add(<span class="hljs-keyword">new</span> SecurityReference(<span class="hljs-string">&quot;token&quot;</span>, authorizationScopes));<br>        <span class="hljs-keyword">return</span> lists;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;SecurityContext&gt; <span class="hljs-title">securityContext</span><span class="hljs-params">()</span> </span>&#123;<br>        SecurityContext securityContext = SecurityContext.builder()<br>                .securityReferences(defaultAuth())<br>                .build();<br>        List&lt;SecurityContext&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        list.add(securityContext);<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="controller-添加描述信息">Controller 添加描述信息</span></h2><p>@Api 可以对Controller进行描述</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Api(tags = &quot;xxx相关接口&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span></span>&#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="接口添加描述信息">接口添加描述信息</span></h2><p>@ApiOperation 可以对接口进行描述</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GETMapping(&quot;/hi&quot;)</span><br><span class="hljs-meta">@ApiOperation(&quot;xxxxx接口&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">hello</span><span class="hljs-params">()</span></span>&#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p><em><strong>@ApiOperation 注解属性</strong></em></p><table><thead><tr><th>注解属性</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>value</td><td>String</td><td>接口说明</td></tr><tr><td>notes</td><td>String</td><td>接口发布说明</td></tr><tr><td>tags</td><td>Stirng[]</td><td>标签</td></tr><tr><td>response</td><td>Class&lt;?&gt;</td><td>接口返回类型</td></tr><tr><td>httpMethod</td><td>String</td><td>接口请求方式</td></tr></tbody></table></li><li><p><em><strong>@ApiIgnore</strong></em><br>  Swagger 文档不会显示拥有该注解的接口。</p></li><li><p><em><strong>@ApiImplicitParams</strong></em><br>  用于描述接口的非对象参数集。</p></li><li><p><em><strong>@ApiImplicitParam</strong></em><br>  用于描述接口的非对象参数，一般与 <em><strong>@ApiImplicitParams</strong></em> 组合使用</p></li></ul><table>    <tr>        <td rowspan="15">@ApiImplicitParam</td>    </tr>    <tr>        <td colspan="3">用在@ApiImplicitParams注解中，指定一个请求参数的各个方面</td>    </tr>    <tr>        <td>name</td>        <td colspan="2">参数名</td>    </tr>    <tr>       <td>value</td>        <td colspan="2">参数的汉字说明、解释</td>    </tr>    <tr>       <td>required</td>        <td colspan="2">参数是否必须传</td>    </tr>    <tr>       <td>dataType</td>       <td colspan="2">参数类型，默认String，其它值dataType="Integer"</td>    </tr>    <tr>       <td>defaultValue</td>        <td colspan="2">参数的默认值</td>    </tr>    <tr>       <td rowspan="8">paramType</td>   </tr>    <tr>       <td colspan="2">参数放在哪个地方</td>    </tr> <tr>       <td>header</td>        <td>请求参数的获取@RequestHeader</td> </tr> <tr>       <td>header</td>        <td>请求参数的获取@RequestHeader</td> </tr> <tr>       <td>query</td>        <td>请求参数的获取@RequestParam</td> </tr> <tr>       <td>path</td>        <td>请求参数的获取@PathVariable</td> </tr> <tr>       <td>body</td>        <td>请求参数的获取@RequestBody</td> </tr> <tr>       <td>form</td>        <td>普通表单提交</td> </tr></table><h2><span id="给实体类添加描述信息">给实体类添加描述信息</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiModel(&quot;用户实体&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entity</span> </span>&#123;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;用户 id&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>@ApiModelProperty 主要属性</li></ul><table><thead><tr><th>注解属性</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>value</td><td>String</td><td>字段说明</td></tr><tr><td>name</td><td>String</td><td>重写字段名称</td></tr><tr><td>dataType</td><td>Stirng</td><td>重写字段类型</td></tr><tr><td>required</td><td>boolean 是否必填</td><td></td></tr><tr><td>example</td><td>Stirng</td><td>举例说明</td></tr><tr><td>hidden</td><td>boolean</td><td>是否在文档中隐藏该字段</td></tr><tr><td>allowEmptyValue</td><td>boolean</td><td>是否允许为空</td></tr><tr><td>allowableValues</td><td>String</td><td>该字段允许的值，当我们 API 的某个参数为枚举类型时，使用这个属性就可以清楚地告诉 API 使用者该参数所能允许传入的值</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;swagger-ui-使用&quot;&gt;Swagger-ui 使用&lt;/span&gt;&lt;/h1&gt;&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E5%BC%95%E5%85%A5%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%9</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>springboot自带的md5摘要算法使用</title>
    <link href="https://mirsery.github.io/2021/06/07/java/Springboot%20%E6%A1%86%E6%9E%B6%E8%87%AA%E5%B8%A6%E7%9A%84md5%E6%91%98%E8%A6%81/"/>
    <id>https://mirsery.github.io/2021/06/07/java/Springboot%20%E6%A1%86%E6%9E%B6%E8%87%AA%E5%B8%A6%E7%9A%84md5%E6%91%98%E8%A6%81/</id>
    <published>2021-06-07T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springboot自带的md5摘要算法使用">springboot自带的md5摘要算法使用</span></h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.util.DigestUtils;<br><br>DigestUtils.md5DigestAsHex(<span class="hljs-string">&quot;需要摘要的字符串xxxxx&quot;</span>.getBytes()); 默认是采用的<span class="hljs-number">32</span>位的md5信息摘要算法<br><br>md5(str,<span class="hljs-number">32</span>)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;springboot自带的md5摘要算法使用&quot;&gt;springboot自带的md5摘要算法使用&lt;/span&gt;&lt;/h1&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
    <category term="md5" scheme="https://mirsery.github.io/tags/md5/"/>
    
  </entry>
  
  <entry>
    <title>RSA 算法加解密代码实现片段</title>
    <link href="https://mirsery.github.io/2021/05/22/java/java%20RSA%20%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/"/>
    <id>https://mirsery.github.io/2021/05/22/java/java%20RSA%20%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/</id>
    <published>2021-05-22T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="rsa-算法加解密代码实现片段">RSA 算法加解密代码实现片段</span></h1><blockquote><p> 采用java</p></blockquote><!-- toc --><ul><li><a href="#%E7%A7%98%E9%92%A5%E7%94%9F%E6%88%90">秘钥生成</a></li><li><a href="#%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86">公钥加密</a></li><li><a href="#%E5%85%AC%E9%92%A5%E8%A7%A3%E5%AF%86">公钥解密</a></li><li><a href="#%E7%A7%81%E9%92%A5%E5%8A%A0%E5%AF%86">私钥加密</a></li><li><a href="#%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86">私钥解密</a></li></ul><!-- tocstop --><h2><span id="秘钥生成">秘钥生成</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initKey</span><span class="hljs-params">()</span> </span>&#123;<br>      KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="hljs-string">&quot;RSA&quot;</span>);<br>      keyPairGenerator.initialize(<span class="hljs-number">2048</span>);<span class="hljs-comment">//长度必须为64的倍数 512~65536 之间</span><br>      KeyPair keyPair = keyPairGenerator.generateKeyPair();<br>      RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); <span class="hljs-comment">//公钥</span><br>      RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();    <span class="hljs-comment">//私钥</span><br>  &#125;<br></code></pre></td></tr></table></figure><h2><span id="公钥加密">公钥加密</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] encryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>      KeyFactory keyFactory = KeyFactory.getInstance(<span class="hljs-string">&quot;RSA&quot;</span>);<br>      X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(key);<br>      PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);<br>      Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>      cipher.init(Cipher.ENCRYPT_MODE, pubKey);<br>      <span class="hljs-keyword">return</span> cipher.doFinal(data);<br>  &#125;<br></code></pre></td></tr></table></figure><h2><span id="公钥解密">公钥解密</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] decryptByPublicKey(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception &#123;<br>       ByteArrayOutputStream out = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>       KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>       X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(Base64.getDecoder().decode(publicKey.trim()));<br>       PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);<br>       Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>       cipher.init(Cipher.DECRYPT_MODE, pubKey);<br>       <span class="hljs-keyword">int</span> inputLen = data.length;<br>       <span class="hljs-keyword">int</span> offSet = <span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">byte</span>[] cache;<br>       <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">while</span> (inputLen - offSet &gt; <span class="hljs-number">0</span>) &#123;<br>           <span class="hljs-keyword">if</span> (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123;<br>               cache = cipher.doFinal(data, offSet, MAX_DECRYPT_BLOCK);<br>           &#125; <span class="hljs-keyword">else</span> &#123;<br>               cache = cipher.doFinal(data, offSet, inputLen - offSet);<br>           &#125;<br>           out.write(cache, <span class="hljs-number">0</span>, cache.length);<br>           i++;<br>           offSet = i * MAX_DECRYPT_BLOCK;<br>       &#125;<br>       out.close();<br>       <span class="hljs-keyword">return</span> out.toByteArray();<br>   &#125;<br></code></pre></td></tr></table></figure><h2><span id="私钥加密">私钥加密</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] encryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>        ByteArrayOutputStream out = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(key);<br>        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);<br>        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>        cipher.init(Cipher.ENCRYPT_MODE, privateKey);<br>        <span class="hljs-keyword">int</span> inputLen = data.length;<br>        <span class="hljs-keyword">int</span> offSet = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">byte</span>[] cache;<br>        <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (inputLen - offSet &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> (inputLen - offSet &gt; MAX_ENCRYPT_BLOCK) &#123;<br>                cache = cipher.doFinal(data, offSet, MAX_ENCRYPT_BLOCK);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cache = cipher.doFinal(data, offSet, inputLen - offSet);<br>            &#125;<br>            out.write(cache, <span class="hljs-number">0</span>, cache.length);<br>            i++;<br>            offSet = i * MAX_ENCRYPT_BLOCK;<br>        &#125;<br>        out.close();<br>        <span class="hljs-keyword">return</span> out.toByteArray();<br>    &#125;<br></code></pre></td></tr></table></figure><h2><span id="私钥解密">私钥解密</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] decryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, <span class="hljs-keyword">byte</span>[] key) <span class="hljs-keyword">throws</span> Exception &#123;<br>        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(key);<br>        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);<br>        PrivateKey privateKey = keyFactory.generatePrivate(pkcs8KeySpec);<br>        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());<br>        cipher.init(Cipher.DECRYPT_MODE, privateKey);<br>        <span class="hljs-keyword">return</span> cipher.doFinal(data);<br>    &#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;rsa-算法加解密代码实现片段&quot;&gt;RSA 算法加解密代码实现片段&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 采用java&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E7%A7%</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="rsa" scheme="https://mirsery.github.io/tags/rsa/"/>
    
    <category term="加密" scheme="https://mirsery.github.io/tags/%E5%8A%A0%E5%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>springboot 中应用缓存（一）</title>
    <link href="https://mirsery.github.io/2021/05/07/java/springboot%20%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98(%E4%B8%80)/"/>
    <id>https://mirsery.github.io/2021/05/07/java/springboot%20%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98(%E4%B8%80)/</id>
    <published>2021-05-07T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springboot-中应用缓存一">springboot 中应用缓存（一）</span></h1><!-- toc --><ul><li><a href="#springboot-%E7%BC%93%E5%AD%98%E6%94%AF%E6%8C%81">springboot 缓存支持</a></li><li><a href="#cachemanager-%E7%9A%84%E4%BD%BF%E7%94%A8">CacheManager 的使用</a></li></ul><!-- tocstop --><p>一般情况的程序的压力瓶颈在数据库。当需要重复的获取相同的数据或者获取的数据更新周期很慢时，我们会进行如果一次又一次直接进行数据库的请求或远程服务的调用会导致IO的阻塞，从而导致程序性能的恶化。</p><h2><span id="springboot-缓存支持">springboot 缓存支持</span></h2><p>springboot定义了org.springframework.cache.CacheManager和org.springframework.cache.Cache接口用来统一不通的缓存技术。其中CacheManager是Spring提供的各种缓存技术抽象接口，Cache接口包含缓存的各种操作（增加、删除、获得缓存）。</p><p>CacheManager 的实现</p><table><thead><tr><th>CacheManager</th><th>描述</th></tr></thead><tbody><tr><td>SimpleCacheManager</td><td>使用简单的Collection来存储缓存，主要用来测试用途</td></tr><tr><td>ConcurrentMapCacheManager</td><td>使用ConcurrentMap来存储缓存</td></tr><tr><td>NoOpCacheManager</td><td>仅做测试用途，不会实际存储缓存</td></tr><tr><td>EhCacheManager</td><td>使用EhCache作为缓存技术</td></tr><tr><td>GuavaCacheManager</td><td>使用Google Guava的GuavaCache做为缓存技术</td></tr><tr><td>HazelcastCacheManager</td><td>使用Hazelcast作为缓存技术</td></tr><tr><td>JCacheCacheManager</td><td>支持JCache（JSR-107)标准的实现作为缓存技术，如Apache Commons JCS</td></tr><tr><td>RedisCacheManager</td><td>使用redis作为缓存技术</td></tr></tbody></table><h2><span id="cachemanager-的使用">CacheManager 的使用</span></h2><blockquote><p>1、 <a href="#CacheManager_1">注册bean</a><br>2、<a href="#CacheManager_2">开启声明缓存支持</a><br>3、<a href="#CacheManager_3">声明缓存规则</a></p></blockquote><ol><li><span id="CacheManager_1">注册Bean</span><br> 在pom.xml中引入如下:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml:n">&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;<br>    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;<br>    &lt;version&gt;2.10.6&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>根据查看源码,可知<strong>spring-boot-starter-cache</strong> 引入<strong>spring-context-support-5.2.2.RELEASE.jar</strong> 包，查看源码<strong>org.springframework.boot.autoconfigure.cache.EhCacheCacheConfiguration</strong></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java:n">/*<br> * Copyright 2012-2019 the original author or authors.<br> *<br> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);<br> * you may not use this file except in compliance with the License.<br> * You may obtain a copy of the License at<br> *<br> *      https://www.apache.org/licenses/LICENSE-2.0<br> *<br> * Unless required by applicable law or agreed to in writing, software<br> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,<br> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br> * See the License for the specific language governing permissions and<br> * limitations under the License.<br> */<br><br>package org.springframework.boot.autoconfigure.cache;<br><br>import net.sf.ehcache.Cache;<br>import net.sf.ehcache.CacheManager;<br><br>import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;<br>import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;<br>import org.springframework.boot.autoconfigure.condition.ResourceCondition;<br>import org.springframework.cache.ehcache.EhCacheCacheManager;<br>import org.springframework.cache.ehcache.EhCacheManagerUtils;<br>import org.springframework.context.annotation.Bean;<br>import org.springframework.context.annotation.Conditional;<br>import org.springframework.context.annotation.Configuration;<br>import org.springframework.core.io.Resource;<br><br>/**<br> * EhCache cache configuration. Only kick in if a configuration file location is set or if<br> * a default configuration file exists.<br> *<br> * @author Eddú Meléndez<br> * @author Stephane Nicoll<br> * @author Madhura Bhave<br> */<br>@Configuration(proxyBeanMethods = false)<br>@ConditionalOnClass(&#123; Cache.class, EhCacheCacheManager.class &#125;)<br>@ConditionalOnMissingBean(org.springframework.cache.CacheManager.class)<br>@Conditional(&#123; CacheCondition.class, EhCacheCacheConfiguration.ConfigAvailableCondition.class &#125;)<br>class EhCacheCacheConfiguration &#123;<br><br>@Bean<br>EhCacheCacheManager cacheManager(CacheManagerCustomizers customizers, CacheManager ehCacheCacheManager) &#123;<br>return customizers.customize(new EhCacheCacheManager(ehCacheCacheManager));<br>&#125;<br><br>@Bean<br>@ConditionalOnMissingBean<br>CacheManager ehCacheCacheManager(CacheProperties cacheProperties) &#123;<br>Resource location = cacheProperties.resolveConfigLocation(cacheProperties.getEhcache().getConfig());<br>if (location != null) &#123;<br>return EhCacheManagerUtils.buildCacheManager(location);<br>&#125;<br>return EhCacheManagerUtils.buildCacheManager();<br>&#125;<br>/**<br> * Determine if the EhCache configuration is available. This either kick in if a<br> * default configuration has been found or if property referring to the file to use<br> * has been set.<br> */<br>static class ConfigAvailableCondition extends ResourceCondition &#123;<br>ConfigAvailableCondition() &#123;<br>super(&quot;EhCache&quot;, &quot;spring.cache.ehcache.config&quot;, &quot;classpath:/ehcache.xml&quot;);<br>&#125;<br><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>可以自动注册bean。配置文件默认地址是<strong>classpath:/ehcache.xml</strong></p><ol><li><span id="CacheManager_2">开启声明缓存支持</span><br> 开启缓存支持只需要在配置类中增加**@EnableCaching**注解即可。</li><li><span id="#CacheManager_3">声明缓存规则</span></li></ol><table><thead><tr><th>注解</th><th>解释</th></tr></thead><tbody><tr><td>@Cacheable</td><td>在方法前spring 先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放进缓存</td></tr><tr><td>@CachePut</td><td>无论怎样，都会将方法的返回值放到缓存中。@CachePut的属性与@Cacheable保存一致。</td></tr><tr><td>@CacheEvict</td><td>将一条或多条数据从缓存中删除</td></tr><tr><td>@Caching</td><td>可以通过@Caching注解组合多个注解策略在一个方法上</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;springboot-中应用缓存一&quot;&gt;springboot 中应用缓存（一）&lt;/span&gt;&lt;/h1&gt;&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#springboot-%E7%BC%93%E5%AD%98%E6%94%AF%E6%8</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
    <category term="cache" scheme="https://mirsery.github.io/tags/cache/"/>
    
  </entry>
  
  <entry>
    <title>springboot 中应用缓存（二）</title>
    <link href="https://mirsery.github.io/2021/05/07/java/springboot%20%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98(%E4%BA%8C)/"/>
    <id>https://mirsery.github.io/2021/05/07/java/springboot%20%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98(%E4%BA%8C)/</id>
    <published>2021-05-07T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<p>#springboot 中应用缓存（二）</p><blockquote><p> 项目中如果引用了shiro框架的话，缓存实例的引用需要增加@lazy标签或者采用手动注入Bean的方式</p></blockquote><!-- toc --><!-- tocstop --><p>##Spring Boot默认的ConcurrentMapCacheManager</p><ol><li>添加缓存</li><li>application中开启**@EnableCaching**标注</li><li>创建service层<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java:n">@Service<br>public class CacheDemoService &#123;<br><br>    @CachePut(value = &quot;test&quot;, key = &quot;#key&quot;)//将返回的数据写入缓存 <br>    public String getMessage(String msg, String key) &#123;<br>        System.out.println(&quot;CachePut the message, key : &quot; + key);<br>        return msg;<br>    &#125;<br><br>    @Cacheable(value = &quot;test&quot;, key = &quot;#key&quot;)    //第一次执行方法缓存，第二次若参数相同时则不会触发方法，而是从缓存中直接返回数据<br>    public String getDemo(String key) &#123;<br>        String msg = &quot;hello world cache&quot;;<br>        System.out.println(&quot;Cacheable the message, key : &quot; + key);<br>        return msg;<br>    &#125;<br><br>    @CacheEvict(value = &quot;test&quot;, key = &quot;#key&quot;)<br>    public void deleteCache(String key) &#123;<br>        System.out.println(&quot;delete the cache key : &quot; + key);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><p>##SpringBoot中使用其他缓存技术<br>###EhCache</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>net.sf.ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <br></code></pre></td></tr></table></figure><p>Springboot 会自动配置EhCacheManager的Bean<br>###Guava</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>18.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>###Redis</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;#springboot 中应用缓存（二）&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; 项目中如果引用了shiro框架的话，缓存实例的引用需要增加@lazy标签或者采用手动注入Bean的方式&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- toc --&gt;



&lt;!-- tocs</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
    <category term="cache" scheme="https://mirsery.github.io/tags/cache/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloud eureka注册中心搭建</title>
    <link href="https://mirsery.github.io/2021/05/03/java/Springcloud%20eureka%20%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E6%90%AD%E5%BB%BA/"/>
    <id>https://mirsery.github.io/2021/05/03/java/Springcloud%20eureka%20%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E6%90%AD%E5%BB%BA/</id>
    <published>2021-05-03T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springcloud-eureka注册中心搭建">SpringCloud eureka注册中心搭建</span></h1><blockquote><p> 搭建eureka注册中心，并集成springboot-admin 监控<br>spring-boot-starter-parent 版本号为 <strong>2.3.10.RELEASE</strong><br>spring-cloud-dependencies 版本为 <strong>Hoxton.SR11</strong></p></blockquote><h2><span id="服务端配置">服务端配置</span></h2><p>服务端直接采用idea新建一个springboot项目，选择对应的版本号以及对应的注册中心。<br>下面是<strong>pom.xml</strong>文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hytiot.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>eureka-hytiot<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>eureka-hytiot<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Demo project for Spring Boot<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud.version</span>&gt;</span>Hoxton.SR11<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">spring-boot-admin.version</span>&gt;</span>2.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">spring-boot-admin.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">docker.image.prefix</span>&gt;</span>docker.hytiot.com<span class="hljs-tag">&lt;/<span class="hljs-name">docker.image.prefix</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">docker-maven-plugin.version</span>&gt;</span>1.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">docker-maven-plugin.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">base-image.name</span>&gt;</span>openjdk:8-jdk-alpine<span class="hljs-tag">&lt;/<span class="hljs-name">base-image.name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maintainer.email</span>&gt;</span>mirsery@hytiot.com<span class="hljs-tag">&lt;/<span class="hljs-name">maintainer.email</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring-boot-admin.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.spotify<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>docker-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;docker-maven-plugin.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">imageName</span>&gt;</span>$&#123;docker.image.prefix&#125;/$&#123;project.artifactId&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageName</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">imageTags</span>&gt;</span>$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageTags</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">baseImage</span>&gt;</span>$&#123;base-image.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">baseImage</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">maintainer</span>&gt;</span>$&#123;maintainer.email&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">maintainer</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">cmd</span>&gt;</span>[&quot;java&quot;, &quot;-version&quot;]<span class="hljs-tag">&lt;/<span class="hljs-name">cmd</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">entryPoint</span>&gt;</span>[&quot;java&quot;, &quot;-jar&quot;, &quot;$&#123;project.build.finalName&#125;.jar&quot;]<span class="hljs-tag">&lt;/<span class="hljs-name">entryPoint</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">targetPath</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">targetPath</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>*.yml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p>配置文件yml为</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xml">spring:<br>  application:<br>    name: eureka-server<br>  security:<br>    user:<br>      name: username<br>      password: password<br>  boot:<br>    admin:<br>        # springboot-admin的访问路径<br>      context-path: /admin<br>server:<br>  port: 8080<br>eureka:<br>  server:<br>    enable-self-preservation: false<br>  instance:<br>    hostname: localhost<br>    instance-id: $&#123;spring.application.name&#125;<br>  client:<br>    # admin need to be discovered<br>    register-with-eureka: true<br>    fetch-registry: true<br>    healthcheck:<br>      enabled: true<br>    service-url:<br>      defaultZone: http://$&#123;spring.security.user.name&#125;:$&#123;spring.security.user.password&#125;@$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/<br>management:<br>  endpoints:<br>    web:<br>      exposure:<br>        include: &quot;*&quot;<br>  endpoint:<br>    health:<br>      show-details: ALWAYS<br></code></pre></td></tr></table></figure><p>同时启动类需要增加**@EnableEurekaServer** 和**@EnableAdminServer**标注,同时需要配置WebSecurity，<br>下面是配置文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebSecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        http.httpBasic()<br>                .and().authorizeRequests()<br>                .antMatchers(<span class="hljs-string">&quot;/actuator/**&quot;</span>).permitAll()<br>                .anyRequest().authenticated()<br>                .and().csrf().disable();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="简易客户端的配置">简易客户端的配置</span></h2><p>下面是<strong>pom.xml</strong>文件内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example.actuator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>actuator-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>actuator-client<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Demo project for Spring Boot<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud.version</span>&gt;</span>Hoxton.SR11<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud.version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p>配置文件内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml">server:<br>  port: 9101<br>spring:<br>  application:<br>    name: demo-client<br>eureka:<br>  client:<br>    service-url:<br>      defaultZone: http://username:password@serverIp:serverPort/eureka/<br>    healthcheck:<br>      enabled: true<br>  instance:<br>    prefer-ip-address: true<br>management:<br>  endpoints:<br>    web:<br>      exposure:<br>        include: &quot;*&quot;<br>  endpoint:<br>    health:<br>      show-details: ALWAYS<br></code></pre></td></tr></table></figure><p>启动类需要增加**@EnableDiscoveryClient**标注。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;springcloud-eureka注册中心搭建&quot;&gt;SpringCloud eureka注册中心搭建&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 搭建eureka注册中心，并集成springboot-admin 监控&lt;br&gt;spring-b</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>Spring 框架中的@import注解</title>
    <link href="https://mirsery.github.io/2021/04/28/java/Spring%20%E4%B8%AD@import%20%E6%B3%A8%E8%A7%A3/"/>
    <id>https://mirsery.github.io/2021/04/28/java/Spring%20%E4%B8%AD@import%20%E6%B3%A8%E8%A7%A3/</id>
    <published>2021-04-28T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="spring-框架中的import注解">Spring 框架中的@import注解</span></h1><blockquote><p> @import注解是Spring基于java注解配置的主要组成部分，import注解提供了@Bean注解的功能，同时还有原来组织多个分散的@Configuration的功能。</p></blockquote><h2><span id="import注解可以引入其他的configuration">import注解可以引入其他的configuration</span></h2><p>example  code :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TestService</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@Import(&#123;ConfigB.class&#125;)</span>     <span class="hljs-comment">//@Import的优先于本身的的类定义加载</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigA</span> </span>&#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TestService <span class="hljs-title">getTestService</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TestServiceA();<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigB</span> </span>&#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TestService <span class="hljs-title">getTestServiceB</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TestServiceB();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>场景类代码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(ConfigA.class);<br>    TestService testService = applicationContext.getBean(TestService.class);<br>    testService.test();<br>    <span class="hljs-comment">//generate TestServiceB</span><br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="import-注解也可以直接初始化其他类的bean">import 注解也可以直接初始化其他类的Bean</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@Import(&#123;TestServiceC.class&#125;)</span>     <span class="hljs-comment">//@Import的优先于本身的的类定义加载</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigA</span> </span>&#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TestService <span class="hljs-title">getTestService</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TestServiceA();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>场景类保持不变，此时TestService实例会变成TestServiceC 的实例。</p><h2><span id="个性化加载指定实现importselector">个性化加载，指定实现ImportSelector</span></h2><p>实现importSelector接口可实现个性化加载，下面是示例代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyimportSelector</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ImportSelector</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Select and return the names of which class(es) should be imported based on the &#123;<span class="hljs-doctag">@link</span> AnnotationMetadata&#125; of the</span><br><span class="hljs-comment">     * importing @&#123;<span class="hljs-doctag">@link</span> Configuration&#125; class.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> importingClassMetadata</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String[] selectImports(AnnotationMetadata importingClassMetadata) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;com.mirsery.test.webtest.anno.TestServiceA&quot;</span>&#125;;<span class="hljs-comment">//    可以直接返回实体或者对应的config配置类</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>基于AnnotationMetadata的参数实现动态加载类示例:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-meta">@Import(My1importSelector.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> EnableTestService &#123;<br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">My1importSelector</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ImportSelector</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Select and return the names of which class(es) should be imported based on the &#123;<span class="hljs-doctag">@link</span> AnnotationMetadata&#125; of the</span><br><span class="hljs-comment">     * importing @&#123;<span class="hljs-doctag">@link</span> Configuration&#125; class.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> importingClassMetadata</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String[] selectImports(AnnotationMetadata importingClassMetadata) &#123;<br>        Map&lt;String , Object&gt; map = importingClassMetadata.getAnnotationAttributes(EnableTestService.class.getName(), <span class="hljs-keyword">true</span>);<br>        String name = (String) map.get(<span class="hljs-string">&quot;name&quot;</span>);<br>        <span class="hljs-keyword">if</span> (Objects.equals(name, <span class="hljs-string">&quot;B&quot;</span>)) &#123;<span class="hljs-comment">//</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;com.mirsery.test.webtest.anno.ConfigB&quot;</span>&#125;;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[<span class="hljs-number">0</span>];<br>    &#125;<br>&#125;<br><br><br>场景类直接使用标注<br><span class="hljs-meta">@EnableTestService(name=&quot;B&quot;)</span><br></code></pre></td></tr></table></figure><h2><span id="实现importbeandefinitionregistrar-接口个性化加载">实现ImportBeanDefinitionRegistrar 接口个性化加载</span></h2><p>和importSelector 类型，想要重新定义Bean，例如动态注入属性改变Bean的类型和Scope等等就需要通过实现ImportBeanDefinitionRegister的类实现,下面是示例代码:<br>//TODO</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;spring-框架中的import注解&quot;&gt;Spring 框架中的@import注解&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; @import注解是Spring基于java注解配置的主要组成部分，import注解提供了@Bean注解的功能，</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
    <category term="annotation" scheme="https://mirsery.github.io/tags/annotation/"/>
    
  </entry>
  
  <entry>
    <title>ByteBuf 引用计数问题</title>
    <link href="https://mirsery.github.io/2021/04/24/java/Bytebuf%20%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/"/>
    <id>https://mirsery.github.io/2021/04/24/java/Bytebuf%20%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/</id>
    <published>2021-04-24T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="bytebuf-引用计数问题">ByteBuf 引用计数问题</span></h1><blockquote><p> netty框架使用过程中关于ByteBuf 的处理<br>SImpleChannelInbound 会release ByteBuf，ChannelInboundHandlerAdapter 不会影响ByteBuf的引用计数</p></blockquote><!-- toc --><ul><li><a href="#%E9%87%87%E7%94%A8%E5%B0%BE%E5%9B%9E%E6%94%B6%E8%87%AA%E5%8A%A8%E9%87%8A%E6%94%BE">采用尾回收自动释放</a></li><li><a href="#%E6%89%8B%E5%8A%A8%E9%87%8A%E6%94%BE">手动释放</a></li></ul><!-- tocstop --><p>下面是使用<strong>EmbeddedChannel</strong>来演示ByteBuf引用计数回收的示例</p><h2><span id="采用尾回收自动释放">采用尾回收自动释放</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">EmbeddedChannel embeddedChannel = <span class="hljs-keyword">new</span> EmbeddedChannel();<br>embeddedChannel.pipeline().addLast(<span class="hljs-keyword">new</span> MyInBound());<br>ByteBuf buf = Unpooled.buffer();<br>buf.writeBytes(<span class="hljs-string">&quot;hello world!&quot;</span>.getBytes(StandardCharsets.UTF_8));<br>embeddedChannel.writeInbound(buf);<br>System.out.println(<span class="hljs-string">&quot;The buf refCnt is &quot;</span> + buf.refCnt());<br><span class="hljs-keyword">try</span> &#123;<br>    Thread.sleep(<span class="hljs-number">10</span> * <span class="hljs-number">1000</span>);<br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInBound</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ChannelInboundHandlerAdapter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;my inbound===&quot;</span>);<br>        ByteBuf byteBuf = (ByteBuf) msg;<br>        System.out.println(byteBuf.slice().toString(CharsetUtil.UTF_8));<br>        ctx.fireChannelRead(byteBuf);<span class="hljs-comment">//must pass Bytebuf 才能出发尾引用计数回收</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="手动释放">手动释放</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInBound</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ChannelInboundHandlerAdapter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;my inbound===&quot;</span>);<br>        ByteBuf byteBuf = (ByteBuf) msg;<br>        System.out.println(byteBuf.slice().toString(CharsetUtil.UTF_8));<br>        byteBuf.release();<br>...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p> netty自带的编码器处理了ByteBuf的引用释放问题 例如：StringDecoder.class</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;bytebuf-引用计数问题&quot;&gt;ByteBuf 引用计数问题&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; netty框架使用过程中关于ByteBuf 的处理&lt;br&gt;SImpleChannelInbound 会release ByteBuf，</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="netty" scheme="https://mirsery.github.io/tags/netty/"/>
    
    <category term="bytebuf" scheme="https://mirsery.github.io/tags/bytebuf/"/>
    
  </entry>
  
  <entry>
    <title>mac下安装app提示已破损</title>
    <link href="https://mirsery.github.io/2021/04/15/mac/mac%20app%E5%B7%B2%E7%A0%B4%E6%8D%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
    <id>https://mirsery.github.io/2021/04/15/mac/mac%20app%E5%B7%B2%E7%A0%B4%E6%8D%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</id>
    <published>2021-04-15T04:02:01.000Z</published>
    <updated>2021-07-14T09:14:01.385Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="mac下安装app提示已破损">mac下安装app提示已破损</span></h1><blockquote><p> 解决某些mac下某些软件安装提示app损坏等情况</p></blockquote><ul><li>方法一 终端执行如下命令,配置允许任何来源的app安装</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo spctl --master-disable<br></code></pre></td></tr></table></figure><ul><li>方法二 终端执行如下命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo xattr -r -d com.apple.quarantine /Applications/[target].app<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">终端执行如下命令,配置允许任何来源的app安装,sudo spctl --master-disable...</summary>
    
    
    
    <category term="mac os" scheme="https://mirsery.github.io/categories/mac-os/"/>
    
    
    <category term="mac" scheme="https://mirsery.github.io/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>netty框架获取websocket协议客户端的真实IP地址问题</title>
    <link href="https://mirsery.github.io/2021/04/14/java/netty%E6%A1%86%E6%9E%B6%E4%B8%AD%E8%8E%B7%E5%8F%96websocket%E5%8D%87%E7%BA%A7%E5%8D%8F%E8%AE%AE%E5%89%8D%E7%9A%84http%20header/"/>
    <id>https://mirsery.github.io/2021/04/14/java/netty%E6%A1%86%E6%9E%B6%E4%B8%AD%E8%8E%B7%E5%8F%96websocket%E5%8D%87%E7%BA%A7%E5%8D%8F%E8%AE%AE%E5%89%8D%E7%9A%84http%20header/</id>
    <published>2021-04-14T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="netty框架获取websocket协议客户端的真实ip地址问题">netty框架获取websocket协议客户端的真实IP地址问题</span></h1><blockquote><p> 背景 目前服务器采用nginx进行反向代理部署，利用socketchannel获取的socketAddress为代理服务器的局域网ip</p></blockquote><h2><span id="代理服务器的配置">代理服务器的配置</span></h2><p>首先代理服务器需将真实的ip地址转发到反向代理的服务上，因此代理服务器需增加代理的请求头。下面是nginx作为代理服务器的样例配置项</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">server &#123;<br>    listen xx;<br>    location / &#123;<br>                client_max_body_size 0;<br>                proxy_redirect http://$host/ http://$http_host/;<br>                proxy_set_header Host $host:$server_port;<br>                proxy_set_header X-Real-IP $remote_addr;<br>                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br>                proxy_pass http://xxxxxx:xxxx;<br>                proxy_http_version 1.1;<br>                proxy_set_header Upgrade $http_upgrade;<br>                proxy_set_header Connection &#x27;upgrade&#x27;;<br>                proxy_read_timeout 600s;<br>      &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>其中** proxy_set_header X-Real-IP $remote_addr;**将真实的客户端ip转发给代理服务中。</p><p>##netty框架中获取传递的<strong>X-Real-IP</strong>请求头地址<br>netty中需要在协议升级之前读取channel的请求头的内容，下面是实例代码。</p><blockquote><p> 该handler需配置在<strong>WebSocketServerProtocolHandler</strong>之前<strong>ChannelInboundHandlerAdapter</strong>不会修改Bytebuf的引用计数问题，详情见<a href="./bytebuf-yin-yong-ji-shu-wen-ti"># ByteBuf 引用计数问题</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpHeadersHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ChannelInboundHandlerAdapter</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String REAL_IP = <span class="hljs-string">&quot;X-Real-IP&quot;</span>;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> IotClientManager clientManager;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-keyword">if</span> (msg <span class="hljs-keyword">instanceof</span> FullHttpRequest) &#123;<br>            FullHttpRequest httpRequest = (FullHttpRequest) msg;<br>            HttpHeaders headers = httpRequest.headers();<br>            String ip = headers.get(REAL_IP);<br>            <span class="hljs-keyword">if</span> (ip != <span class="hljs-keyword">null</span>) &#123;<br>                clientManager.setIP(ctx.channel(), ip);<br>            &#125;<br>        &#125;<br>        ctx.fireChannelRead(msg);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;netty框架获取websocket协议客户端的真实ip地址问题&quot;&gt;netty框架获取websocket协议客户端的真实IP地址问题&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 背景 目前服务器采用nginx进行反向代理部署，利用socke</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="netty" scheme="https://mirsery.github.io/tags/netty/"/>
    
  </entry>
  
  <entry>
    <title>springboot自带的事件驱动模型使用</title>
    <link href="https://mirsery.github.io/2021/02/28/java/Springboot%E8%87%AA%E5%B8%A6%E7%9A%84%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E4%BD%BF%E7%94%A8/"/>
    <id>https://mirsery.github.io/2021/02/28/java/Springboot%E8%87%AA%E5%B8%A6%E7%9A%84%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E4%BD%BF%E7%94%A8/</id>
    <published>2021-02-28T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springboot自带的事件驱动模型使用">springboot自带的事件驱动模型使用</span></h1><blockquote><p> Springboot框架自行封装了一套发布订阅模式可以供我们日常开发的使用</p></blockquote><p>##自定义事件类<br>在springboot中继承 <strong>ApplicationEvent</strong>类可以实现自定义事件<br>下面是示例代码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String message;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TestEvent</span><span class="hljs-params">(Object source, String message)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(source);<br>        <span class="hljs-keyword">this</span>.message = message;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getMessage</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> message;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMessage</span><span class="hljs-params">(String message)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.message = message;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>##定义事件监听组件<br>只要实现<strong>ApplicationListner<t>接口</t></strong>，组件就可以订阅相关的事件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestEventListerner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationListener</span>&lt;<span class="hljs-title">TestEvent</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Handle an application event.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> event the event to respond to</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onApplicationEvent</span><span class="hljs-params">(TestEvent event)</span> </span>&#123;<br>        System.out.println(<span class="hljs-keyword">this</span>.getClass() + <span class="hljs-string">&quot; message is &quot;</span> + event.getMessage() + <span class="hljs-string">&quot;, source is :&quot;</span> + event.getSource());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="事件发布">事件发布</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ApplicationContext applicationContext = SpringApplication.run(WebTestApplication.class, args);<br>TestEvent test = <span class="hljs-keyword">new</span> TestEvent(<span class="hljs-string">&quot;test-code&quot;</span>, <span class="hljs-string">&quot;测试事件发生&quot;</span>);<br>applicationContext.publishEvent(test);<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;springboot自带的事件驱动模型使用&quot;&gt;springboot自带的事件驱动模型使用&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; Springboot框架自行封装了一套发布订阅模式可以供我们日常开发的使用&lt;/p&gt;
&lt;/blockquot</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>springboot自动配置</title>
    <link href="https://mirsery.github.io/2021/02/28/java/springboot%E8%87%AA%E5%8A%A8%E5%8C%96%E9%85%8D%E7%BD%AE/"/>
    <id>https://mirsery.github.io/2021/02/28/java/springboot%E8%87%AA%E5%8A%A8%E5%8C%96%E9%85%8D%E7%BD%AE/</id>
    <published>2021-02-28T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="自动配置">自动配置</span></h1><h2><span id="自动配置中使用的条件化注解">自动配置中使用的条件化注解</span></h2><table><thead><tr><th align="center">条件化注解</th><th align="center">配置生效条件</th></tr></thead><tbody><tr><td align="center">@ConditionalOnBean</td><td align="center">配置了某个特定的Bean</td></tr><tr><td align="center">@ConditionalOnMissingBean</td><td align="center">没有配置特定的Bean</td></tr><tr><td align="center">@ConditionalOnClass</td><td align="center">Classpath中有特定的类</td></tr><tr><td align="center">@ConditionalOnMissingClass</td><td align="center">Classpath中缺少指定的类</td></tr><tr><td align="center">@ConditionalOnExpression</td><td align="center">给定的Spring Expression Language(SpEL)表达式计算结果为true</td></tr><tr><td align="center">@ConditionalOnJava</td><td align="center">Java版本匹配特定值或者或者一个范围值</td></tr><tr><td align="center">@ConditionalOnJndi</td><td align="center">参数中给定的JND的位置必须存在一个，如果没有参数，则要有JNDI InitialContext</td></tr><tr><td align="center">@ConditionalOnProperty</td><td align="center">指定的配置属性要有一个明确的值</td></tr><tr><td align="center">@ConditionalOnResource</td><td align="center">Classpath里需要有特定的资源</td></tr><tr><td align="center">@ConditionalOnWebApplication</td><td align="center">这是一个web应用</td></tr><tr><td align="center">@ConditionalOnNotWebApplication</td><td align="center">非web应用</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;自动配置&quot;&gt;自动配置&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;自动配置中使用的条件化注解&quot;&gt;自动配置中使用的条件化注解&lt;/span&gt;&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;条件化注解&lt;/th&gt;</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>NIO SelectionKey 类解析</title>
    <link href="https://mirsery.github.io/2021/01/05/java/Java%20NIO%20SelectionKey/"/>
    <id>https://mirsery.github.io/2021/01/05/java/Java%20NIO%20SelectionKey/</id>
    <published>2021-01-05T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="nio-selectionkey-类解析">NIO SelectionKey 类解析</span></h1><blockquote><p> A token representing the registration of a SelectableChannel with a Selector.</p></blockquote><!-- toc --><ul><li><a href="#selectionkey%E7%B1%BB%E8%A7%A3%E9%87%8A%E4%BB%A5%E5%8F%8A%E7%94%A8%E6%B3%95">SelectionKey类解释以及用法</a></li><li><a href="#%E5%8F%98%E9%87%8F">变量</a><ul><li><a href="#op_accept-1-4"><strong>OP_ACCEPT</strong> 1 &lt;&lt; 4</a></li><li><a href="#op_connect-1-3"><strong>OP_CONNECT</strong> 1 &lt;&lt; 3</a></li><li><a href="#op_read-1-0"><strong>OP_READ</strong> 1 &lt;&lt; 0</a></li><li><a href="#op_write-1-2"><strong>OP_WRITE</strong> 1 &lt;&lt; 2</a></li></ul></li><li><a href="#%E6%96%B9%E6%B3%95">方法</a><ul><li><a href="#public-abstract-selectablechannel-channel"><strong>public abstract SelectableChannel channel()</strong></a></li></ul></li></ul><!-- tocstop --><h2><span id="selectionkey类解释以及用法">SelectionKey类解释以及用法</span></h2><p><img src="./_image/2021/969959BD-AB3E-4F9B-9133-ACDF5C67AEF6.png"><br>以下是 <strong>javadoc</strong> 对 <strong>SelectionKey</strong> 的解释：<br>A token representing the registration of a SelectableChannel with a Selector.</p><p>A selection key is created each time a channel is registered with a selector. A key remains valid until it is cancelled by invoking its cancel method, by closing its channel, or by closing its selector. Cancelling a key does not immediately remove it from its selector; it is instead added to the selector’s cancelled-key set for removal during the next selection operation. The validity of a key may be tested by invoking its isValid method.</p><p>A selection key contains two operation sets represented as integer values. Each bit of an operation set denotes a category of selectable operations that are supported by the key’s channel.</p><p>The interest set determines which operation categories will be tested for readiness the next time one of the selector’s selection methods is invoked. The interest set is initialized with the value given when the key is created; it may later be changed via the interestOps(int) method.</p><p>The ready set identifies the operation categories for which the key’s channel has been detected to be ready by the key’s selector. The ready set is initialized to zero when the key is created; it may later be updated by the selector during a selection operation, but it cannot be updated directly.</p><p>That a selection key’s ready set indicates that its channel is ready for some operation category is a hint, but not a guarantee, that an operation in such a category may be performed by a thread without causing the thread to block. A ready set is most likely to be accurate immediately after the completion of a selection operation. It is likely to be made inaccurate by external events and by I/O operations that are invoked upon the corresponding channel.</p><p>This class defines all known operation-set bits, but precisely which bits are supported by a given channel depends upon the type of the channel. Each subclass of SelectableChannel defines an validOps() method which returns a set identifying just those operations that are supported by the channel. An attempt to set or test an operation-set bit that is not supported by a key’s channel will result in an appropriate run-time exception.</p><p>It is often necessary to associate some application-specific data with a selection key, for example an object that represents the state of a higher-level protocol and handles readiness notifications in order to implement that protocol. Selection keys therefore support the attachment of a single arbitrary object to a key. An object can be attached via the attach method and then later retrieved via the attachment method.</p><p>Selection keys are safe for use by multiple concurrent threads.The operations of reading and writing the interest set will, in general, be synchronized with certain operations of the selector.Exactly how this synchronization is performed is implementation-dependent: In a naive implementation, reading or writing the interest set may block indefinitely if a selection operation is already in progress; in a high-performance implementation, reading or writing the interest set may block briefly, if at all. In any case, a selection operation will always use the interest-set value that was current at the moment that the operation began.</p><blockquote><p>selector is thread safe but Selectionkeys’s set is not!</p></blockquote><h2><span id="变量">变量</span></h2><h3><span id="op_accept-1-ltlt-4"><strong>OP_ACCEPT</strong>  1 &lt;&lt; 4</span></h3><blockquote><p> Operation-set bit for socket-accept operations<br>Suppose that a selection key’s interest set contains <strong>OP_ACCEPT</strong> at the start of a selection operation. If the selector detects that the corresponding server-socket channel is ready to accept another connection, or has an error pending, then it will add <strong>OP_ACCEPT</strong> to the key’s ready set and add the key to its <strong>selected-key set</strong>.</p></blockquote><h3><span id="op_connect-1-ltlt-3"><strong>OP_CONNECT</strong> 1 &lt;&lt; 3</span></h3><blockquote><p>Operation-set bit for socket-connect operations.<br>Operation-set bit for socket-connect operations.<br>Suppose that a selection key’s interest set contains <strong>OP_CONNECT</strong> at the start of a selection operation. If the selector detects that the corresponding socket channel is ready to complete its connection sequence, or has an error pending, then it will add <strong>OP_CONNECT</strong> to the key’s ready set and add the key to its <strong>selected-key set</strong>.</p></blockquote><h3><span id="op_read-1-ltlt-0"><strong>OP_READ</strong> 1 &lt;&lt; 0</span></h3><blockquote><p>Operation-set bit for read operations.<br>Operation-set bit for read operations.<br>Suppose that a selection key’s interest set contains <strong>OP_READ</strong> at the start of a selection operation. If the selector detects that the corresponding channel is ready for reading, has reached end-of-stream, has been remotely shut down for further reading, or has an error pending, then it will add <strong>OP_READ</strong> to the key’s ready-operation set and add the key to its <strong>selected-key set</strong>.</p></blockquote><h3><span id="op_write-1-ltlt-2"><strong>OP_WRITE</strong> 1 &lt;&lt; 2</span></h3><blockquote><p> Operation-set bit for write operations.<br>Operation-set bit for write operations.<br>Suppose that a selection key’s interest set contains <strong>OP_WRITE</strong> at the start of a selection operation. If the selector detects that the corresponding channel is ready for writing, has been remotely shut down for further writing, or has an error pending, then it will add <strong>OP_WRITE</strong> to the key’s ready set and add the key to its <strong>selected-key set</strong>.</p></blockquote><h2><span id="方法">方法</span></h2><h3><span id="public-abstract-selectablechannel-channel"><strong>public abstract SelectableChannel channel()</strong></span></h3><blockquote><p> Returns the channel for which this key was created.<br> This method will continue to return the selector even after the key is cancelled.</p></blockquote>]]></content>
    
    
    <summary type="html">A token representing the registration of a SelectableChannel with a Selector.....</summary>
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="nio" scheme="https://mirsery.github.io/tags/nio/"/>
    
    <category term="socket" scheme="https://mirsery.github.io/tags/socket/"/>
    
  </entry>
  
  <entry>
    <title>Springboot 中干掉if else</title>
    <link href="https://mirsery.github.io/2021/01/05/java/springBoot%E4%B8%AD%E6%9B%BF%E6%8D%A2if-else/"/>
    <id>https://mirsery.github.io/2021/01/05/java/springBoot%E4%B8%AD%E6%9B%BF%E6%8D%A2if-else/</id>
    <published>2021-01-05T16:00:00.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springboot-中干掉if-else">Springboot 中干掉if else</span></h1><blockquote><p> 来自：掘金（作者：cipher）<br>原文链接 <a href="https://juejin.im/post/5c551122e51d457fcc5a9790">https://juejin.im/post/5c551122e51d457fcc5a9790</a></p></blockquote><h2><span id="需求">需求</span></h2><p>这里虚拟一个业务需求，让大家容易理解。假设有一个订单系统，里面的一个功能是根据订单的不同类型作出不同的处理。<br>订单实体:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderDTO</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String code;<br>    <span class="hljs-keyword">private</span> BigDecimal price;<br>    <span class="hljs-keyword">private</span> String type;  <br>&#125;<br></code></pre></td></tr></table></figure><p>service接口:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IOrderService</span> </span>&#123;<br>            <span class="hljs-comment">/**</span><br><span class="hljs-comment">            * 根据订单的不同类型做出不同的处理</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> dto 订单实体</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@return</span> </span><br><span class="hljs-comment">            */</span><br>            <span class="hljs-function">String <span class="hljs-title">handle</span><span class="hljs-params">(OrderDTO dto)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>##传统实现<br>根据订单类写一堆的if-else:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IOrderService</span> </span>&#123;<br>    String type = dto.getType();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;1&quot;</span>.equals(type))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;处理普通订单&quot;</span>;<br>        &#125;<span class="hljs-function">elese <span class="hljs-title">if</span><span class="hljs-params">(<span class="hljs-string">&quot;2&quot;</span>.equals(type)</span>)</span>&#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;处理团购订单&quot;</span>;<br>       &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;3&quot;</span>.equals(type))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;处理促销订单&quot;</span>;<br>      &#125;                <br>     <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2><span id="策略模式实现">策略模式实现</span></h2><p>利用策略模式只需要实现两行可实现业务逻辑:<br>@Service<br>public class OrderServiceV2Impl implements IOrderService {<br>    @Autowrited<br>    private HandlerContext handlerContext;</p><pre><code>@Overridepublic String handle(OrderDTO dto)&#123;    AbstractHandler handler = handlerContext.getInstance(dto.getType());    return handler.handle(dto);</code></pre><p>   }<br>}<br>可以看到上面的方法中注入了HandlerContext，这是一个处理器上下文，用来保存不同的业务处理器，具体在下文会讲解。我们从中获取一个抽象的处理器AbstractHandler，调用其方法实现业务逻辑。<br>现在可以了解到，我们主要的业务逻辑是在处理器中实现的，因此有多少个订单类型，就对应有多少个处理器。以后需求变化，增加了订单类型，只需要添加相应的处理器就可以，上述OrderServiceV2Impl完全不需改动。</p><hr><p>以上是转自网友 cipher 的文章,今天突然发现springboot可以注入同一接口实现的services集合就想到可以利用其value属性实现策略模式.<br>修改时间 2021-01-06 23:51:58</p><pre><code>其实在springboot中实现策略模式，我们可以利用springboot本身提供的@service 注解以及其 同一接口的实现的Map注入就可以解决。下面简单的举个例子。</code></pre><p>首先我们先定一个接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DataListener</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onData</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>接着定义几个实现该接口的类 DataListener1, DataListener2.<br>我们在实现的类DataListener1…上增加@service注解，同时给他命名（其默认名可以为字符串类型的策略），接着我们定义一个场景类<strong>DataHandleContext</strong>,<br>场景类中引入如下变量：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowrite</span><br><span class="hljs-keyword">public</span> Map&lt;String,DataListener&gt; dataListenerMap;<span class="hljs-comment">//该类是所定义的策略的map集合</span><br></code></pre></td></tr></table></figure><p>至此，我们就很简单的实现了策略模式。策略的命名可以采用枚举类进行控制，这样新增策略时只需要在枚举类中新增相应的枚举类型以及新建相关的service层类。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;springboot-中干掉if-else&quot;&gt;Springboot 中干掉if else&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 来自：掘金（作者：cipher）&lt;br&gt;原文链接 &lt;a href=&quot;https://juejin.im/p</summary>
      
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="转载" scheme="https://mirsery.github.io/tags/%E8%BD%AC%E8%BD%BD/"/>
    
    <category term="springboot" scheme="https://mirsery.github.io/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>mac 改变lauchpad图标的大小</title>
    <link href="https://mirsery.github.io/2020/08/07/mac/%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%ADMac%E7%9A%84Microsoft%20AutoUpdate%E5%BC%B9%E6%A1%86%E6%8F%90%E7%A4%BA/"/>
    <id>https://mirsery.github.io/2020/08/07/mac/%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%ADMac%E7%9A%84Microsoft%20AutoUpdate%E5%BC%B9%E6%A1%86%E6%8F%90%E7%A4%BA/</id>
    <published>2020-08-07T03:40:11.000Z</published>
    <updated>2021-07-14T09:14:01.385Z</updated>
    
    <content type="html"><![CDATA[<p>#如何关闭Mac的Microsoft AutoUpdate弹框提示</p><p>最简单直接方法就是删除 Microsoft AutoUpdate.APP<br>首先打开**/Library/Application Support/Microsoft/<strong>路径，删除</strong>MAU2.0**文件夹即可</p>]]></content>
    
    
    <summary type="html">首先打开**/Library/Application Support/Microsoft/**路径，删除**MAU2.0**文件夹即可...</summary>
    
    
    
    <category term="mac os" scheme="https://mirsery.github.io/categories/mac-os/"/>
    
    
    <category term="mac" scheme="https://mirsery.github.io/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>springboot事务机制</title>
    <link href="https://mirsery.github.io/2020/07/09/java/(%E6%9C%AA%E5%AE%8C%E6%88%90)springboot%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6/"/>
    <id>https://mirsery.github.io/2020/07/09/java/(%E6%9C%AA%E5%AE%8C%E6%88%90)springboot%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6/</id>
    <published>2020-07-09T05:47:45.000Z</published>
    <updated>2021-07-14T09:14:01.381Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="springboot-事务机制">springboot 事务机制</span></h1><p>Spring 的事务机制提供了一个PlatformTranctionManager接口，不同的数据访问技术的事务使用不同的接口实现。</p><table><thead><tr><th align="center">数据访问技术</th><th align="center">实现</th></tr></thead><tbody><tr><td align="center">JDBC</td><td align="center">DataSourceTransactionManager</td></tr><tr><td align="center">JPA</td><td align="center">JpaTransactionManager</td></tr><tr><td align="center">Hirbernate</td><td align="center">HibernateTransactionManager</td></tr><tr><td align="center">JDO</td><td align="center">JdoTransactionManager</td></tr><tr><td align="center">分布式事务</td><td align="center">JtaTransactionManager</td></tr></tbody></table><p>定义事务管理器:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java:n"><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">待完善...</summary>
    
    
    
    <category term="java" scheme="https://mirsery.github.io/categories/java/"/>
    
    
    <category term="事务" scheme="https://mirsery.github.io/tags/%E4%BA%8B%E5%8A%A1/"/>
    
  </entry>
  
</feed>
